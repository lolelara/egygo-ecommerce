import{H as v,f as y,J as b,r as w,j as s,g as k,a7 as o,a2 as c,h as C,aY as q}from"./vendor-react-BTCGZZAN.js";import{o as F,a as S,u as P,q as x,C as m,f as h,e as l,g as u,B as n,E as p}from"./index-DAwEpow4.js";import{S as $}from"./SEO-d2yAp_P1.js";import"./vendor-ui-BA32w1ww.js";import"./vendor-query-GexG3wnZ.js";import"./vendor-other-ws_0vYaO.js";import"./vendor-animations-W1Z2cmit.js";import"./vendor-appwrite-BQhTxLk4.js";function H(){const{user:t}=F(),{addItem:g}=S(),{toast:r}=P(),j=v(),{data:i=[],isLoading:N}=y({queryKey:x.wishlist((t==null?void 0:t.$id)||""),queryFn:()=>p.getUserWishlist((t==null?void 0:t.$id)||""),enabled:!!(t!=null&&t.$id)}),d=b({mutationFn:({id:e})=>p.removeFromWishlist(e,(t==null?void 0:t.$id)||""),onSuccess:()=>{j.invalidateQueries({queryKey:x.wishlist((t==null?void 0:t.$id)||"")}),r({title:"تم الحذف",description:"تم حذف المنتج من قائمة المفضلة"})},onError:e=>{r({title:"خطأ",description:e.message||"فشل في حذف المنتج",variant:"destructive"})}}),f=e=>{var a;g({productId:e.id,name:e.name,price:e.price,image:u((a=e.images)==null?void 0:a[0]),quantity:1,stockQuantity:e.stockQuantity||e.stock||0,inStock:e.inStock??e.isActive??!0}),r({title:"تم الإضافة",description:"تم إضافة المنتج إلى السلة"})};return w.useEffect(()=>{t||(window.location.href="/login")},[t]),t?N?s.jsx("div",{className:"container mx-auto px-4 py-8",children:s.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:s.jsxs("div",{className:"text-center",children:[s.jsx(k,{className:"mx-auto h-12 w-12 text-muted-foreground animate-pulse"}),s.jsx("p",{className:"mt-4 text-muted-foreground",children:"جاري التحميل..."})]})})}):s.jsxs(s.Fragment,{children:[s.jsx($,{title:"قائمة المفضلة",description:"عرض وإدارة المنتجات المفضلة لديك"}),s.jsxs("div",{className:"container mx-auto px-4 py-8",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx(o,{className:"h-8 w-8 text-accent fill-accent"}),s.jsx("h1",{className:"text-3xl font-bold",children:"قائمة المفضلة"})]}),s.jsxs("p",{className:"text-muted-foreground",children:["لديك ",i.length," ",i.length===1?"منتج":"منتجات"," في قائمة المفضلة"]})]}),i.length===0?s.jsx(m,{children:s.jsx(h,{className:"py-16",children:s.jsxs("div",{className:"text-center",children:[s.jsx(o,{className:"mx-auto h-16 w-16 text-muted"}),s.jsx("h3",{className:"mt-4 text-xl font-semibold",children:"قائمة المفضلة فارغة"}),s.jsx("p",{className:"mt-2 text-muted-foreground",children:"لم تقم بإضافة أي منتجات إلى قائمة المفضلة بعد"}),s.jsx(c,{to:"/products",children:s.jsx(l,{className:"mt-6",children:"تصفح المنتجات"})})]})})}):s.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:i.map(e=>{var a;return s.jsx(m,{className:"group hover:shadow-lg transition-shadow",children:s.jsxs(h,{className:"p-4",children:[s.jsx(c,{to:`/products/${e.productId}`,children:s.jsxs("div",{className:"relative aspect-square mb-4 rounded-lg overflow-hidden bg-gray-100",children:[s.jsx("img",{src:u((a=e.product.images)==null?void 0:a[0]),alt:e.product.name,className:"w-full h-full object-cover group-hover:scale-105 transition-transform"}),!e.product.inStock&&s.jsx("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center",children:s.jsx(n,{variant:"destructive",children:"غير متوفر"})}),e.product.originalPrice&&s.jsxs(n,{className:"absolute top-2 left-2 bg-red-500",children:["خصم ",Math.round((e.product.originalPrice-e.product.price)/e.product.originalPrice*100),"%"]})]})}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(c,{to:`/products/${e.productId}`,children:s.jsx("h3",{className:"font-semibold text-lg line-clamp-2 hover:text-primary",children:e.product.name})}),e.product.category&&s.jsx(n,{variant:"outline",className:"text-xs",children:e.product.category.name}),e.product.rating>0&&s.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[s.jsx("span",{className:"text-yellow-500",children:"★"}),s.jsx("span",{className:"font-medium",children:e.product.rating.toFixed(1)}),s.jsxs("span",{className:"text-gray-500",children:["(",e.product.reviewCount,")"]})]}),s.jsxs("div",{className:"flex items-baseline gap-2",children:[s.jsxs("span",{className:"text-2xl font-bold text-primary",children:[e.product.price.toFixed(2)," جنيه"]}),e.product.originalPrice&&s.jsxs("span",{className:"text-sm text-gray-500 line-through",children:[e.product.originalPrice.toFixed(2)," جنيه"]})]}),s.jsxs("div",{className:"flex gap-2 pt-2",children:[s.jsxs(l,{onClick:()=>f(e.product),disabled:!e.product.inStock,className:"flex-1",children:[s.jsx(C,{className:"h-4 w-4 ml-2"}),"أضف للسلة"]}),s.jsx(l,{variant:"outline",size:"icon",onClick:()=>d.mutate({id:e.id}),disabled:d.isPending,children:s.jsx(q,{className:"h-4 w-4 text-red-500"})})]})]})]})},e.id)})})]})]}):null}export{H as default};
