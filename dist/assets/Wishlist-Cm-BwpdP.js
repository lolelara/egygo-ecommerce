import{w as f,c as v,b as y,x as b,y as w,z as d,E as k,F as o,r as C,j as s,o as F,H as x,C as u,g as m,d as r,B as c,G as h,a as l,J as S,T as q}from"./index-Ce-RwxJS.js";import{S as P}from"./SEO-CvYl5atu.js";function I(){const{user:a}=f(),{addItem:p}=v(),{toast:i}=y(),g=b(),{data:t=[],isLoading:j}=w({queryKey:d.wishlist(a?.$id||""),queryFn:()=>o.getUserWishlist(a?.$id||""),enabled:!!a?.$id}),n=k({mutationFn:({id:e})=>o.removeFromWishlist(e,a?.$id||""),onSuccess:()=>{g.invalidateQueries({queryKey:d.wishlist(a?.$id||"")}),i({title:"تم الحذف",description:"تم حذف المنتج من قائمة المفضلة"})},onError:e=>{i({title:"خطأ",description:e.message||"فشل في حذف المنتج",variant:"destructive"})}}),N=e=>{p({productId:e.id,name:e.name,price:e.price,image:h(e.images?.[0]),quantity:1,stockQuantity:e.stockQuantity||e.stock||0,inStock:e.inStock??e.isActive??!0}),i({title:"تم الإضافة",description:"تم إضافة المنتج إلى السلة"})};return C.useEffect(()=>{a||(window.location.href="/login")},[a]),a?j?s.jsx("div",{className:"container mx-auto px-4 py-8",children:s.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:s.jsxs("div",{className:"text-center",children:[s.jsx(F,{className:"mx-auto h-12 w-12 text-muted-foreground animate-pulse"}),s.jsx("p",{className:"mt-4 text-muted-foreground",children:"جاري التحميل..."})]})})}):s.jsxs(s.Fragment,{children:[s.jsx(P,{title:"قائمة المفضلة",description:"عرض وإدارة المنتجات المفضلة لديك"}),s.jsxs("div",{className:"container mx-auto px-4 py-8",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx(x,{className:"h-8 w-8 text-accent fill-accent"}),s.jsx("h1",{className:"text-3xl font-bold",children:"قائمة المفضلة"})]}),s.jsxs("p",{className:"text-muted-foreground",children:["لديك ",t.length," ",t.length===1?"منتج":"منتجات"," في قائمة المفضلة"]})]}),t.length===0?s.jsx(u,{children:s.jsx(m,{className:"py-16",children:s.jsxs("div",{className:"text-center",children:[s.jsx(x,{className:"mx-auto h-16 w-16 text-muted"}),s.jsx("h3",{className:"mt-4 text-xl font-semibold",children:"قائمة المفضلة فارغة"}),s.jsx("p",{className:"mt-2 text-muted-foreground",children:"لم تقم بإضافة أي منتجات إلى قائمة المفضلة بعد"}),s.jsx(r,{to:"/products",children:s.jsx(c,{className:"mt-6",children:"تصفح المنتجات"})})]})})}):s.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:t.map(e=>s.jsx(u,{className:"group hover:shadow-lg transition-shadow",children:s.jsxs(m,{className:"p-4",children:[s.jsx(r,{to:`/products/${e.productId}`,children:s.jsxs("div",{className:"relative aspect-square mb-4 rounded-lg overflow-hidden bg-gray-100",children:[s.jsx("img",{src:h(e.product.images?.[0]),alt:e.product.name,className:"w-full h-full object-cover group-hover:scale-105 transition-transform"}),!e.product.inStock&&s.jsx("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center",children:s.jsx(l,{variant:"destructive",children:"غير متوفر"})}),e.product.originalPrice&&s.jsxs(l,{className:"absolute top-2 left-2 bg-red-500",children:["خصم ",Math.round((e.product.originalPrice-e.product.price)/e.product.originalPrice*100),"%"]})]})}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(r,{to:`/products/${e.productId}`,children:s.jsx("h3",{className:"font-semibold text-lg line-clamp-2 hover:text-primary",children:e.product.name})}),e.product.category&&s.jsx(l,{variant:"outline",className:"text-xs",children:e.product.category.name}),e.product.rating>0&&s.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[s.jsx("span",{className:"text-yellow-500",children:"★"}),s.jsx("span",{className:"font-medium",children:e.product.rating.toFixed(1)}),s.jsxs("span",{className:"text-gray-500",children:["(",e.product.reviewCount,")"]})]}),s.jsxs("div",{className:"flex items-baseline gap-2",children:[s.jsxs("span",{className:"text-2xl font-bold text-primary",children:[e.product.price.toFixed(2)," جنيه"]}),e.product.originalPrice&&s.jsxs("span",{className:"text-sm text-gray-500 line-through",children:[e.product.originalPrice.toFixed(2)," جنيه"]})]}),s.jsxs("div",{className:"flex gap-2 pt-2",children:[s.jsxs(c,{onClick:()=>N(e.product),disabled:!e.product.inStock,className:"flex-1",children:[s.jsx(S,{className:"h-4 w-4 ml-2"}),"أضف للسلة"]}),s.jsx(c,{variant:"outline",size:"icon",onClick:()=>n.mutate({id:e.id}),disabled:n.isPending,children:s.jsx(q,{className:"h-4 w-4 text-red-500"})})]})]})]})},e.id))})]})]}):null}export{I as default};
