import{a8 as y,a9 as K,a0 as i,aD as ie,w as ae,r as g,u as F,j as e,L as ce,C as f,e as p,f as N,o as U,g as v,av as ee,ac as Y,a6 as q,B as h,P as B,aE as oe,I as se,ap as de,aq as me,ar as xe,as as ue,at as V,a as L,N as ne,T as he,ax as je,d as E,J as G,ab as ge,aa as fe,ae as J,q as pe,a1 as Ne}from"./index-Ce-RwxJS.js";import{A as Q}from"./AdminLayout-DRAN_nM7.js";import{P as ve}from"./PendingApprovalScreen-B5jbSVio.js";import{T as we,a as ye,b as X,c as R,d as be,e as O}from"./table-DhT4s9qg.js";import{T as Z}from"./trending-down-SSQIHDEp.js";import{D as Se}from"./download-UgG-gTV9.js";import{U as ke}from"./upload-BkldABOD.js";import{S as le}from"./square-pen-BvEjHzCI.js";import{A as Ie}from"./arrow-up-right-zD7_oLce.js";import"./tag-BB9opunb.js";import"./settings-DdUeHZqS.js";import"./clock-D_TAAEO_.js";import"./phone-D4T1FDJZ.js";const I=K.databaseId,C=K.collections,Ce=K.storageId;function De(l){if(!l)return"/placeholder.svg";if(typeof l=="object"&&l.url)return l.url;if(typeof l=="string"){if(l.startsWith("http://")||l.startsWith("https://"))return l;try{return ie.getFileView(Ce,l).toString()}catch(s){return console.error("Error getting image URL:",s),"/placeholder.svg"}}return"/placeholder.svg"}async function Pe(l){try{console.log("Fetching merchant stats for user:",l);let s;try{s=await y.listDocuments(I,C.products,[i.equal("merchantId",l),i.limit(1e3)]),console.log("Fetched products with merchantId filter:",s.documents.length)}catch(w){console.warn("merchantId attribute not found, fetching all products:",w.message),s=await y.listDocuments(I,C.products,[i.limit(1e3)])}const a=s.documents,t=a.length,c=a.filter(w=>w.stock>0).length,o=a.filter(w=>w.stock===0).length,x=a.map(w=>w.$id);let u=0,k=0,b=0,S=0;if(x.length>0){const w=await y.listDocuments(I,C.orderItems,[i.equal("productId",x),i.limit(1e3)]);for(const T of w.documents){u+=T.quantity||0,k+=(T.price||0)*(T.quantity||0);try{const r=await y.getDocument(I,C.orders,T.orderId);r.status==="pending"||r.status==="processing"?b++:r.status==="delivered"&&S++}catch(r){console.error("Error fetching order:",r)}}}const n=new Date,j=new Date(n.getTime()-720*60*60*1e3),D=new Date(n.getTime()-1440*60*60*1e3);let _=0,P=0;x.length>0&&(_=(await y.listDocuments(I,C.orderItems,[i.equal("productId",x),i.greaterThan("$createdAt",j.toISOString()),i.limit(1e3)])).documents.reduce((r,m)=>r+(m.price||0)*(m.quantity||0),0),P=(await y.listDocuments(I,C.orderItems,[i.equal("productId",x),i.greaterThan("$createdAt",D.toISOString()),i.lessThan("$createdAt",j.toISOString()),i.limit(1e3)])).documents.reduce((r,m)=>r+(m.price||0)*(m.quantity||0),0));const H=P>0?(_-P)/P*100:0;let M=0,A=0;if(x.length>0){const w=await y.listDocuments(I,C.reviews,[i.equal("productId",x),i.limit(1e3)]);A=w.documents.length,A>0&&(M=w.documents.reduce((r,m)=>r+(m.rating||0),0)/A)}return{totalProducts:t,activeProducts:c,outOfStock:o,totalSales:u,totalRevenue:k,revenueChange:H,pendingOrders:b,completedOrders:S,avgRating:parseFloat(M.toFixed(1)),totalReviews:A}}catch(s){throw console.error("Error fetching merchant stats:",s),s}}async function $e(l){try{console.log("Fetching merchant products for user:",l);let s;try{s=await y.listDocuments(I,C.products,[i.equal("merchantId",l),i.orderDesc("$createdAt"),i.limit(100)]),console.log("Fetched products with merchantId filter:",s.documents.length)}catch{console.warn("merchantId attribute not found, fetching all products"),s=await y.listDocuments(I,C.products,[i.orderDesc("$createdAt"),i.limit(100)])}const a=[];for(const t of s.documents){const c=await y.listDocuments(I,C.orderItems,[i.equal("productId",t.$id),i.limit(1e3)]),o=c.documents.reduce((S,n)=>S+(n.quantity||0),0),x=c.documents.reduce((S,n)=>S+(n.price||0)*(n.quantity||0),0),u=await y.listDocuments(I,C.reviews,[i.equal("productId",t.$id),i.limit(1e3)]),k=u.documents.length>0?u.documents.reduce((S,n)=>S+(n.rating||0),0)/u.documents.length:0;let b="active";t.stock===0?b="out_of_stock":t.isActive===!1&&(b="draft"),a.push({id:t.$id,name:t.name||"",image:De(t.images?.[0]),price:t.price||0,stock:t.stock||0,sales:o,revenue:x,views:0,rating:parseFloat(k.toFixed(1)),status:b,categoryId:t.categoryId,description:t.description,merchantId:l})}return a}catch(s){throw console.error("Error fetching merchant products:",s),s}}async function Oe(l){try{console.log("Fetching merchant orders for user:",l);const s=await y.listDocuments(I,C.orders,[i.orderDesc("$createdAt"),i.limit(100)]),a=[];for(const t of s.documents){const c=t.items||[],o=c.reduce((x,u)=>x+(u.price||0)*(u.quantity||0),0);a.push({id:t.$id,orderId:t.$id,product:c.length>0?c[0].name:"منتج",customer:t.customerName||t.customerEmail||"عميل",amount:o,status:t.status||"pending",date:new Date(t.$createdAt).toISOString().split("T")[0]})}return a}catch(s){throw console.error("Error fetching merchant orders:",s),s}}const te=K.databaseId,re="products";class Te{async getMerchantProducts(s){try{return(await y.listDocuments(te,re,[i.equal("merchantId",s),i.orderDesc("$updatedAt")])).documents.map(t=>this.mapToInventoryProduct(t))}catch(a){return console.error("Error fetching merchant products:",a),[]}}async updateStock(s,a){try{const t=this.getStockStatus(a);return await y.updateDocument(te,re,s,{stock:a,status:t,lastUpdated:new Date().toISOString()}),!0}catch(t){return console.error("Error updating stock:",t),!1}}async getInventoryStats(s){try{const a=await this.getMerchantProducts(s);return{total:a.length,inStock:a.filter(c=>c.status==="in_stock").length,lowStock:a.filter(c=>c.status==="low_stock").length,outOfStock:a.filter(c=>c.status==="out_of_stock").length,totalValue:a.reduce((c,o)=>c+o.stock*o.price,0)}}catch(a){return console.error("Error fetching inventory stats:",a),{total:0,inStock:0,lowStock:0,outOfStock:0,totalValue:0}}}async searchProducts(s,a){try{const t=await this.getMerchantProducts(s);if(!a)return t;const c=a.toLowerCase();return t.filter(o=>o.name.toLowerCase().includes(c)||o.sku.toLowerCase().includes(c))}catch(t){return console.error("Error searching products:",t),[]}}async filterByStatus(s,a){try{const t=await this.getMerchantProducts(s);return a==="all"?t:t.filter(c=>c.status===a)}catch(t){return console.error("Error filtering products:",t),[]}}async getLowStockProducts(s){try{return(await this.getMerchantProducts(s)).filter(t=>t.status==="low_stock")}catch(a){return console.error("Error fetching low stock products:",a),[]}}exportToCSV(s){const a=["الاسم","SKU","المخزون","السعر","الفئة","الحالة"],t=s.map(c=>[c.name,c.sku,c.stock.toString(),c.price.toString(),c.category,this.getStatusLabel(c.status)]);return[a,...t].map(c=>c.join(",")).join(`
`)}async bulkUpdateFromCSV(s,a){try{const t=a.split(`
`).slice(1);let c=0,o=0;for(const x of t){const[u,k,b]=x.split(",");if(!k||!b){o++;continue}const n=(await this.getMerchantProducts(s)).find(j=>j.sku===k.trim());n&&await this.updateStock(n.$id,parseInt(b))?c++:o++}return{success:c,failed:o}}catch(t){return console.error("Error bulk updating from CSV:",t),{success:0,failed:0}}}mapToInventoryProduct(s){const a=s.stock||0,t=this.getStockStatus(a);return{$id:s.$id,name:s.name||"منتج بدون اسم",sku:s.sku||s.$id.substring(0,8).toUpperCase(),stock:a,price:s.price||0,category:s.category||"غير مصنف",status:t,lastUpdated:s.$updatedAt||s.$createdAt,merchantId:s.merchantId||"",image:s.images?.[0]||s.image||""}}getStockStatus(s){return s===0?"out_of_stock":s<10?"low_stock":"in_stock"}getStatusLabel(s){switch(s){case"in_stock":return"متوفر";case"low_stock":return"مخزون منخفض";case"out_of_stock":return"نفذ المخزون";default:return"غير معروف"}}}const z=new Te;function Ee(){const{user:l}=ae(),[s,a]=g.useState([]),[t,c]=g.useState([]),[o,x]=g.useState(""),[u,k]=g.useState("all"),[b,S]=g.useState(null),[n,j]=g.useState(!1),[D,_]=g.useState(!0),[P,H]=g.useState({total:0,inStock:0,lowStock:0,outOfStock:0,totalValue:0});g.useEffect(()=>{M()},[l]);const M=async()=>{if(l?.$id){_(!0);try{const r=await z.getMerchantProducts(l.$id);a(r.map(d=>({id:d.$id,name:d.name,sku:d.sku,stock:d.stock,price:d.price,category:d.category,status:d.status,lastUpdated:d.lastUpdated,merchantId:d.merchantId}))),c(r.map(d=>({id:d.$id,name:d.name,sku:d.sku,stock:d.stock,price:d.price,category:d.category,status:d.status,lastUpdated:d.lastUpdated,merchantId:d.merchantId})));const m=await z.getInventoryStats(l.$id);H(m)}catch(r){console.error("Error loading inventory:",r),F.error("فشل تحميل المخزون")}finally{_(!1)}}};g.useEffect(()=>{let r=s;o&&(r=r.filter(m=>m.name.toLowerCase().includes(o.toLowerCase())||m.sku.toLowerCase().includes(o.toLowerCase()))),u!=="all"&&(r=r.filter(m=>m.status===u)),c(r)},[o,u,s]);const A=r=>{switch(r){case"in_stock":return e.jsx(L,{className:"bg-green-500",children:"متوفر"});case"low_stock":return e.jsx(L,{className:"bg-yellow-500",children:"مخزون منخفض"});case"out_of_stock":return e.jsx(L,{className:"bg-red-500",children:"نفذ المخزون"});default:return e.jsx(L,{children:"غير معروف"})}},w=async(r,m)=>{try{await z.updateStock(r,m)?(await M(),F.success("تم تحديث المخزون بنجاح")):F.error("فشل تحديث المخزون")}catch(d){console.error("Error updating stock:",d),F.error("فشل تحديث المخزون")}},T=()=>{const r=z.exportToCSV(t.map($=>({$id:$.id,name:$.name,sku:$.sku,stock:$.stock,price:$.price,category:$.category,status:$.status,lastUpdated:$.lastUpdated,merchantId:$.merchantId}))),m=new Blob([r],{type:"text/csv;charset=utf-8;"}),d=window.URL.createObjectURL(m),W=document.createElement("a");W.href=d,W.download=`inventory-${new Date().toISOString().split("T")[0]}.csv`,W.click(),window.URL.revokeObjectURL(d),F.success("تم تصدير البيانات بنجاح")};return D?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ce,{className:"h-8 w-8 animate-spin text-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-5",children:[e.jsxs(f,{children:[e.jsxs(p,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(N,{className:"text-sm font-medium",children:"إجمالي المنتجات"}),e.jsx(U,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(v,{children:e.jsx("div",{className:"text-2xl font-bold",children:P.total})})]}),e.jsxs(f,{className:"bg-green-50 border-green-200",children:[e.jsxs(p,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(N,{className:"text-sm font-medium text-green-900",children:"متوفر"}),e.jsx(U,{className:"h-4 w-4 text-green-600"})]}),e.jsx(v,{children:e.jsx("div",{className:"text-2xl font-bold text-green-900",children:P.inStock})})]}),e.jsxs(f,{className:"bg-yellow-50 border-yellow-200",children:[e.jsxs(p,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(N,{className:"text-sm font-medium text-yellow-900",children:"مخزون منخفض"}),e.jsx(ee,{className:"h-4 w-4 text-yellow-600"})]}),e.jsx(v,{children:e.jsx("div",{className:"text-2xl font-bold text-yellow-900",children:P.lowStock})})]}),e.jsxs(f,{className:"bg-red-50 border-red-200",children:[e.jsxs(p,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(N,{className:"text-sm font-medium text-red-900",children:"نفذ المخزون"}),e.jsx(Z,{className:"h-4 w-4 text-red-600"})]}),e.jsx(v,{children:e.jsx("div",{className:"text-2xl font-bold text-red-900",children:P.outOfStock})})]}),e.jsxs(f,{className:"bg-purple-50 border-purple-200",children:[e.jsxs(p,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(N,{className:"text-sm font-medium text-purple-900",children:"قيمة المخزون"}),e.jsx(Y,{className:"h-4 w-4 text-purple-600"})]}),e.jsx(v,{children:e.jsxs("div",{className:"text-2xl font-bold text-purple-900",children:["$",P.totalValue.toLocaleString()]})})]})]}),e.jsxs(f,{children:[e.jsx(p,{children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(N,{children:"إدارة المخزون"}),e.jsx(q,{children:"تتبع وإدارة مخزون منتجاتك"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(h,{variant:"outline",size:"sm",onClick:T,children:[e.jsx(Se,{className:"w-4 h-4 ml-2"}),"تصدير"]}),e.jsxs(h,{variant:"outline",size:"sm",children:[e.jsx(ke,{className:"w-4 h-4 ml-2"}),"استيراد"]}),e.jsxs(h,{size:"sm",className:"bg-purple-600 hover:bg-purple-700",children:[e.jsx(B,{className:"w-4 h-4 ml-2"}),"منتج جديد"]})]})]})}),e.jsxs(v,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(oe,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(se,{placeholder:"ابحث عن منتج أو SKU...",value:o,onChange:r=>x(r.target.value),className:"pr-10"})]}),e.jsxs(de,{value:u,onValueChange:k,children:[e.jsx(me,{className:"w-full md:w-[200px]",children:e.jsx(xe,{placeholder:"حالة المخزون"})}),e.jsxs(ue,{children:[e.jsx(V,{value:"all",children:"جميع الحالات"}),e.jsx(V,{value:"in_stock",children:"متوفر"}),e.jsx(V,{value:"low_stock",children:"مخزون منخفض"}),e.jsx(V,{value:"out_of_stock",children:"نفذ المخزون"})]})]})]}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(we,{children:[e.jsx(ye,{children:e.jsxs(X,{children:[e.jsx(R,{children:"المنتج"}),e.jsx(R,{children:"SKU"}),e.jsx(R,{children:"المخزون"}),e.jsx(R,{children:"السعر"}),e.jsx(R,{children:"الفئة"}),e.jsx(R,{children:"الحالة"}),e.jsx(R,{children:"آخر تحديث"}),e.jsx(R,{className:"text-left",children:"الإجراءات"})]})}),e.jsx(be,{children:t.length===0?e.jsx(X,{children:e.jsx(O,{colSpan:8,className:"text-center py-8 text-muted-foreground",children:"لا توجد منتجات"})}):t.map(r=>e.jsxs(X,{children:[e.jsx(O,{className:"font-medium",children:r.name}),e.jsx(O,{children:e.jsx(L,{variant:"outline",children:r.sku})}),e.jsx(O,{children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(se,{type:"number",value:r.stock,onChange:m=>w(r.id,parseInt(m.target.value)||0),className:"w-20",min:"0"})})}),e.jsxs(O,{children:["$",r.price]}),e.jsx(O,{children:r.category}),e.jsx(O,{children:A(r.status)}),e.jsx(O,{className:"text-muted-foreground text-sm",children:r.lastUpdated}),e.jsx(O,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(h,{variant:"ghost",size:"icon",children:e.jsx(ne,{className:"w-4 h-4"})}),e.jsx(h,{variant:"ghost",size:"icon",children:e.jsx(le,{className:"w-4 h-4"})}),e.jsx(h,{variant:"ghost",size:"icon",className:"text-red-600 hover:text-red-700",children:e.jsx(he,{className:"w-4 h-4"})})]})})]},r.id))})]})})]})]}),P.lowStock>0&&e.jsxs(f,{className:"border-yellow-200 bg-yellow-50",children:[e.jsx(p,{children:e.jsxs(N,{className:"flex items-center gap-2 text-yellow-900",children:[e.jsx(ee,{className:"w-5 h-5"}),"تنبيهات المخزون المنخفض"]})}),e.jsx(v,{children:e.jsx("div",{className:"space-y-2",children:s.filter(r=>r.status==="low_stock").map(r=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:r.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["المخزون المتبقي: ",r.stock]})]}),e.jsx(h,{size:"sm",variant:"outline",children:"إعادة الطلب"})]},r.id))})})]})]})}function We(){const{user:l}=ae();if(l?.isMerchant&&l?.accountStatus==="pending")return e.jsx(ve,{});if(!l?.isMerchant)return e.jsx(je,{to:"/",replace:!0});const[s,a]=g.useState(null),[t,c]=g.useState([]),[o,x]=g.useState([]),[u,k]=g.useState(!0),[b,S]=g.useState(null);return g.useEffect(()=>{if(!l)return;(async()=>{try{k(!0),S(null);const[j,D,_]=await Promise.all([Pe(l.$id),$e(l.$id),Oe(l.$id)]);a(j),c(D.slice(0,3)),x(_.slice(0,3))}catch(j){console.error("Error fetching merchant data:",j),S("حدث خطأ أثناء تحميل البيانات")}finally{k(!1)}})()},[l]),u?e.jsx(Q,{children:e.jsx("div",{className:"flex items-center justify-center h-[60vh]",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx(ce,{className:"h-8 w-8 animate-spin text-primary"}),e.jsx("p",{className:"text-muted-foreground",children:"جاري تحميل البيانات..."})]})})}):b||!s?e.jsx(Q,{children:e.jsx("div",{className:"flex items-center justify-center h-[60vh]",children:e.jsxs(f,{className:"w-full max-w-md",children:[e.jsxs(p,{children:[e.jsx(N,{className:"text-destructive",children:"خطأ"}),e.jsx(q,{children:b||"فشل تحميل البيانات"})]}),e.jsx(v,{children:e.jsx(h,{onClick:()=>window.location.reload(),children:"إعادة المحاولة"})})]})})}):e.jsx(Q,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"لوحة تحكم التاجر"}),e.jsxs("p",{className:"text-muted-foreground",children:["مرحباً ",l?.name,"، إليك ملخص منتجاتك ومبيعاتك"]})]}),e.jsx(E,{to:"/admin/products",children:e.jsxs(h,{children:[e.jsx(B,{className:"h-4 w-4 ml-2"}),"إضافة منتج جديد"]})})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(f,{children:[e.jsxs(p,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(N,{className:"text-sm font-medium",children:"إجمالي المنتجات"}),e.jsx(U,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(v,{children:[e.jsx("div",{className:"text-2xl font-bold",children:s.totalProducts}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[s.activeProducts," نشط، ",s.outOfStock," ","نفذت من المخزون"]})]})]}),e.jsxs(f,{children:[e.jsxs(p,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(N,{className:"text-sm font-medium",children:"إجمالي المبيعات"}),e.jsx(G,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(v,{children:[e.jsx("div",{className:"text-2xl font-bold",children:s.totalSales}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[s.pendingOrders," قيد التنفيذ"]})]})]}),e.jsxs(f,{children:[e.jsxs(p,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(N,{className:"text-sm font-medium",children:"الإيرادات"}),e.jsx(ge,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(v,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["$",s.totalRevenue.toLocaleString()]}),e.jsxs("div",{className:"flex items-center text-xs mt-1",children:[(s.revenueChange||0)>=0?e.jsxs(e.Fragment,{children:[e.jsx(fe,{className:"h-3 w-3 text-green-500 ml-1"}),e.jsxs("span",{className:"text-green-500",children:["+",(s.revenueChange||0).toFixed(1),"%"]})]}):e.jsxs(e.Fragment,{children:[e.jsx(Z,{className:"h-3 w-3 text-red-500 ml-1"}),e.jsxs("span",{className:"text-red-500",children:[(s.revenueChange||0).toFixed(1),"%"]})]}),e.jsx("span",{className:"text-muted-foreground mr-1",children:"عن الشهر الماضي"})]})]})]}),e.jsxs(f,{children:[e.jsxs(p,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(N,{className:"text-sm font-medium",children:"التقييم"}),e.jsx(J,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(v,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[s.avgRating,"/5.0"]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[s.totalReviews," تقييم"]})]})]})]}),e.jsx(Ee,{}),e.jsxs(f,{children:[e.jsx(p,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx(N,{children:"أداء المنتجات"}),e.jsx(q,{children:"أفضل منتجاتك أداءً هذا الشهر"})]}),e.jsx(E,{to:"/admin/products",children:e.jsxs(h,{variant:"outline",size:"sm",children:["عرض الكل ",e.jsx(Ie,{className:"h-4 w-4 mr-1"})]})})]})}),e.jsx(v,{children:e.jsx("div",{className:"space-y-4",children:t.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(U,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"لا توجد منتجات بعد"}),e.jsx(E,{to:"/admin/products",children:e.jsxs(h,{className:"mt-4",size:"sm",children:[e.jsx(B,{className:"h-4 w-4 ml-1"}),"إضافة منتج"]})})]}):t.map(n=>{const j={active:{label:"نشط",variant:"default"},out_of_stock:{label:"نفذ من المخزون",variant:"destructive"},draft:{label:"مسودة",variant:"secondary"}},D=j[n.status]||j.active;return e.jsxs("div",{className:"flex items-center gap-4 p-4 rounded-lg border",children:[e.jsx("img",{src:n.image,alt:n.name,className:"h-16 w-16 rounded object-cover"}),e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-semibold",children:n.name}),e.jsx(L,{variant:D.variant,children:D.label})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"السعر"}),e.jsxs("p",{className:"font-medium",children:["$",n.price]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"المبيعات"}),e.jsx("p",{className:"font-medium",children:n.sales})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"الإيرادات"}),e.jsxs("p",{className:"font-medium",children:["$",n.revenue.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"المشاهدات"}),e.jsx("p",{className:"font-medium",children:n.views})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pe,{value:n.stock>0?Math.min(n.stock/100*100,100):0,className:"flex-1"}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[n.stock," في المخزون"]})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(E,{to:`/admin/products/${n.id}`,children:e.jsxs(h,{variant:"outline",size:"sm",children:[e.jsx(le,{className:"h-4 w-4 ml-1"}),"تعديل"]})}),e.jsx(E,{to:`/products/${n.id}`,children:e.jsxs(h,{variant:"outline",size:"sm",children:[e.jsx(ne,{className:"h-4 w-4 ml-1"}),"معاينة"]})})]})]},n.id)})})})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(f,{children:[e.jsxs(p,{children:[e.jsx(N,{children:"الطلبات الأخيرة"}),e.jsx(q,{children:"آخر طلبات منتجاتك"})]}),e.jsx(v,{children:e.jsx("div",{className:"space-y-3",children:o.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(G,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"لا توجد طلبات بعد"})]}):o.map(n=>{const j={pending:{label:"قيد الانتظار",variant:"secondary"},processing:{label:"قيد المعالجة",variant:"secondary"},shipped:{label:"تم الشحن",variant:"default"},delivered:{label:"تم التسليم",variant:"default"},cancelled:{label:"ملغي",variant:"destructive"}},D=j[n.status]||j.pending;return e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"font-medium",children:["#",n.orderId.slice(0,8)]}),e.jsx(L,{variant:D.variant,children:D.label})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[n.product," - ",n.customer]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:n.date})]}),e.jsxs("div",{className:"text-lg font-bold",children:["$",n.amount.toLocaleString()]})]},n.id)})})})]}),e.jsxs(f,{children:[e.jsxs(p,{children:[e.jsx(N,{children:"تنبيهات ونصائح"}),e.jsx(q,{children:"تحسينات مقترحة"})]}),e.jsx(v,{children:e.jsxs("div",{className:"space-y-3",children:[s.outOfStock>0&&e.jsxs("div",{className:"flex gap-3 p-3 rounded-lg border border-yellow-200 bg-yellow-50",children:[e.jsx(Ne,{className:"h-5 w-5 text-yellow-600 shrink-0"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"font-medium text-sm",children:"منتجات نفذت من المخزون"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["لديك ",s.outOfStock," منتجات نفذت من المخزون. قم بتحديث الكميات."]})]})]}),s.revenueChange>0&&e.jsxs("div",{className:"flex gap-3 p-3 rounded-lg border border-blue-200 bg-blue-50",children:[e.jsx(Y,{className:"h-5 w-5 text-blue-600 shrink-0"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"font-medium text-sm",children:"أداء ممتاز"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["مبيعاتك زادت بنسبة ",(s.revenueChange||0).toFixed(1),"% هذا الشهر!"]})]})]}),s.revenueChange<0&&e.jsxs("div",{className:"flex gap-3 p-3 rounded-lg border border-red-200 bg-red-50",children:[e.jsx(Z,{className:"h-5 w-5 text-red-600 shrink-0"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"font-medium text-sm",children:"انخفاض في المبيعات"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["مبيعاتك انخفضت بنسبة ",Math.abs(s.revenueChange||0).toFixed(1),"% هذا الشهر."]})]})]}),s.totalReviews>0&&e.jsxs("div",{className:"flex gap-3 p-3 rounded-lg border border-green-200 bg-green-50",children:[e.jsx(J,{className:"h-5 w-5 text-green-600 shrink-0"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"font-medium text-sm",children:"تقييمات رائعة"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["لديك ",s.totalReviews," تقييم بمتوسط ",s.avgRating,"/5"]})]})]}),s.pendingOrders>0&&e.jsxs("div",{className:"flex gap-3 p-3 rounded-lg border border-orange-200 bg-orange-50",children:[e.jsx(G,{className:"h-5 w-5 text-orange-600 shrink-0"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"font-medium text-sm",children:"طلبات قيد المعالجة"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["لديك ",s.pendingOrders," طلب يحتاج إلى معالجة"]})]})]}),s.totalProducts===0&&e.jsxs("div",{className:"flex gap-3 p-3 rounded-lg border border-gray-200 bg-gray-50",children:[e.jsx(U,{className:"h-5 w-5 text-gray-600 shrink-0"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"font-medium text-sm",children:"ابدأ بإضافة منتجات"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"لم تضف أي منتجات بعد. ابدأ بإضافة منتجك الأول!"})]})]})]})})]})]}),e.jsxs(f,{children:[e.jsx(p,{children:e.jsx(N,{children:"إجراءات سريعة"})}),e.jsx(v,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(E,{to:"/admin/products",children:e.jsx(h,{variant:"outline",className:"w-full h-auto py-4",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(B,{className:"h-6 w-6"}),e.jsx("span",{children:"إضافة منتج"})]})})}),e.jsx(E,{to:"/admin/products",children:e.jsx(h,{variant:"outline",className:"w-full h-auto py-4",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(U,{className:"h-6 w-6"}),e.jsx("span",{children:"إدارة المنتجات"})]})})}),e.jsx(E,{to:"/admin/categories",children:e.jsx(h,{variant:"outline",className:"w-full h-auto py-4",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(Y,{className:"h-6 w-6"}),e.jsx("span",{children:"إدارة الفئات"})]})})}),e.jsx(h,{variant:"outline",className:"w-full h-auto py-4",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(J,{className:"h-6 w-6"}),e.jsx("span",{children:"عرض التقييمات"})]})})]})})]})]})})}export{We as default};
