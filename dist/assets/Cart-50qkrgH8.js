import{r as x,j as e,B as l,X as O,I as H,L as U,a as v,u,b as K,c as X,d as j,A as L,C,e as k,f as w,T as P,g as S,S as A,M as G,P as J,D as V,h as W,i as Y,k as Z,l as _,m as ee,n as se,o as ae}from"./index-Ce-RwxJS.js";import{c as te}from"./coupons-api-KlkOGt2E.js";import{T}from"./tag-BB9opunb.js";import{S as le}from"./shopping-bag-CvqvafLt.js";function ne({cartTotal:m,onCouponApplied:c,onCouponRemoved:y,appliedCoupon:n}){const[o,r]=x.useState(""),[i,h]=x.useState(!1),d=async()=>{if(!o.trim()){u.error("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙˆØ¯ Ø§Ù„ÙƒÙˆØ¨ÙˆÙ†");return}h(!0);try{const a=await te.validateCoupon(o,m);a.valid&&a.coupon&&a.discount?(c(a.discount,a.coupon),u.success(a.message||"ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙƒÙˆØ¨ÙˆÙ† Ø¨Ù†Ø¬Ø§Ø­!"),r("")):u.error(a.message||"Ø§Ù„ÙƒÙˆØ¨ÙˆÙ† ØºÙŠØ± ØµØ§Ù„Ø­")}catch(a){console.error("Error applying coupon:",a),u.error("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙƒÙˆØ¨ÙˆÙ†")}finally{h(!1)}},p=()=>{y(),r(""),u.success("ØªÙ… Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ÙƒÙˆØ¨ÙˆÙ†")};return e.jsxs("div",{className:"space-y-3",children:[n?e.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"h-4 w-4 text-green-600"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-green-900",children:["ÙƒÙˆØ¨ÙˆÙ† Ù…Ø·Ø¨Ù‚: ",e.jsx("span",{className:"font-mono",children:n.code})]}),e.jsx("p",{className:"text-xs text-green-700",children:n.type==="percentage"?`Ø®ØµÙ… ${n.value}%`:`Ø®ØµÙ… ${n.value} Ø¬.Ù…`})]})]}),e.jsx(l,{variant:"ghost",size:"sm",onClick:p,className:"text-green-700 hover:text-green-900",children:e.jsx(O,{className:"h-4 w-4"})})]}):e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(T,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(H,{value:o,onChange:a=>r(a.target.value.toUpperCase()),placeholder:"Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„ÙƒÙˆØ¨ÙˆÙ†",className:"pr-10",disabled:i,onKeyPress:a=>{a.key==="Enter"&&d()}})]}),e.jsx(l,{onClick:d,disabled:i||!o.trim(),className:"min-w-[100px]",children:i?e.jsxs(e.Fragment,{children:[e.jsx(U,{className:"h-4 w-4 animate-spin ml-2"}),"Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚"]}):"ØªØ·Ø¨ÙŠÙ‚"})]}),!n&&e.jsx("div",{className:"flex flex-wrap gap-2",children:e.jsx(v,{variant:"outline",className:"text-xs",children:"ðŸ’¡ Ø§Ø³ØªØ®Ø¯Ù… ÙƒÙˆØ¨ÙˆÙ† Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø®ØµÙ…"})})]})}function xe(){const{toast:m}=K(),{items:c,removeItem:y,updateQuantity:n,clearCart:o,subtotal:r}=X(),[i,h]=x.useState(null),[d,p]=x.useState(0),a=(s,t)=>{if(t<1)return;const b=c.find(M=>M.id===s);if(b){if(t>b.stockQuantity){m({title:"Ø§Ù„ÙƒÙ…ÙŠØ© ØºÙŠØ± Ù…ØªÙˆÙØ±Ø©",description:`Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…ØªÙˆÙØ±Ø© ÙÙ‚Ø· ${b.stockQuantity}`,variant:"destructive"});return}n(s,t)}},[R,g]=x.useState(!1),[z,D]=x.useState(null),q=s=>{D(s),g(!0)},$=()=>{z&&(y(z),m({title:"ØªÙ…Øª Ø§Ù„Ø¥Ø²Ø§Ù„Ø©",description:"ØªÙ… Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù…Ù†ØªØ¬ Ù…Ù† Ø§Ù„Ø³Ù„Ø©"})),g(!1),D(null)},B=()=>{o(),m({title:"ØªÙ… Ø¥ÙØ±Ø§Øº Ø§Ù„Ø³Ù„Ø©",description:"ØªÙ… Ø¥Ø²Ø§Ù„Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù…Ù† Ø§Ù„Ø³Ù„Ø©"})},E=(s,t)=>{p(s),h(t)},Q=()=>{p(0),h(null)},I=c.reduce((s,t)=>s+(t.originalPrice||t.price)*t.quantity,0)-r,N=r-d,f=N>=500?0:50,F=N+f;return c.length===0?e.jsx("div",{className:"min-h-screen bg-background",children:e.jsx("div",{className:"container mx-auto px-4 py-16",children:e.jsxs("div",{className:"text-center space-y-6",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"p-6 bg-muted rounded-full",children:e.jsx(le,{className:"h-16 w-16 text-muted-foreground"})})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Ø³Ù„Ø© Ø§Ù„ØªØ³ÙˆÙ‚ ÙØ§Ø±ØºØ©"}),e.jsx("p",{className:"text-muted-foreground",children:"Ù„Ù… ØªÙ‚Ù… Ø¨Ø¥Ø¶Ø§ÙØ© Ø£ÙŠ Ù…Ù†ØªØ¬Ø§Øª Ø¥Ù„Ù‰ Ø³Ù„Ø© Ø§Ù„ØªØ³ÙˆÙ‚ Ø¨Ø¹Ø¯"})]}),e.jsx(l,{size:"lg",asChild:!0,children:e.jsxs(j,{to:"/products",children:["ØªØµÙØ­ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª",e.jsx(L,{className:"mr-2 h-5 w-5 rtl:mr-0 rtl:ml-2 rtl:rotate-180"})]})})]})})}):e.jsx("div",{className:"min-h-screen bg-background",children:e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Ø³Ù„Ø© Ø§Ù„ØªØ³ÙˆÙ‚"}),e.jsxs("p",{className:"text-muted-foreground",children:["Ù„Ø¯ÙŠÙƒ ",c.length," Ù…Ù†ØªØ¬ ÙÙŠ Ø§Ù„Ø³Ù„Ø©"]})]}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2 space-y-4",children:e.jsxs(C,{children:[e.jsxs(k,{className:"flex flex-row items-center justify-between",children:[e.jsx(w,{children:"Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª"}),e.jsxs(l,{variant:"ghost",size:"sm",onClick:B,className:"text-destructive hover:text-destructive",children:[e.jsx(P,{className:"h-4 w-4 ml-2 rtl:ml-0 rtl:mr-2"}),"Ø¥ÙØ±Ø§Øº Ø§Ù„Ø³Ù„Ø©"]})]}),e.jsx(S,{className:"space-y-4",children:c.map((s,t)=>e.jsxs("div",{children:[t>0&&e.jsx(A,{className:"my-4"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(j,{to:`/product/${s.productId}`,className:"flex-shrink-0",children:e.jsx("img",{src:s.image,alt:s.name,className:"w-24 h-24 object-cover rounded-lg"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(j,{to:`/product/${s.productId}`,className:"hover:text-primary",children:e.jsx("h3",{className:"font-semibold mb-1 line-clamp-2",children:s.name})}),(s.color||s.size)&&e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.color&&e.jsxs(v,{variant:"outline",className:"text-xs",children:["Ø§Ù„Ù„ÙˆÙ†: ",s.color]}),s.size&&e.jsxs(v,{variant:"outline",className:"text-xs",children:["Ø§Ù„Ù…Ù‚Ø§Ø³: ",s.size]})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsxs("span",{className:"text-lg font-bold text-primary",children:[s.price.toLocaleString()," Ø¬.Ù…"]}),s.originalPrice&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-sm text-muted-foreground line-through",children:[s.originalPrice.toLocaleString()," Ø¬.Ù…"]}),e.jsxs(v,{variant:"secondary",className:"text-xs",children:["ÙˆÙØ±"," ",Math.round((s.originalPrice-s.price)/s.originalPrice*100),"%"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center border rounded-lg",children:[e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>a(s.id,s.quantity-1),disabled:s.quantity<=1,children:e.jsx(G,{className:"h-4 w-4"})}),e.jsx("span",{className:"px-4 py-2 font-medium min-w-[3rem] text-center",children:s.quantity}),e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>a(s.id,s.quantity+1),disabled:s.quantity>=s.stockQuantity,children:e.jsx(J,{className:"h-4 w-4"})})]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Ù…ØªÙˆÙØ±: ",s.stockQuantity]})]})]}),e.jsxs(V,{open:R,onOpenChange:g,children:[e.jsx(W,{asChild:!0,children:e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>q(s.id),className:"flex-shrink-0",children:e.jsx(P,{className:"h-5 w-5 text-destructive"})})}),e.jsxs(Y,{children:[e.jsx(Z,{children:e.jsx(_,{children:"ØªØ£ÙƒÙŠØ¯ Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù…Ù†ØªØ¬"})}),e.jsx("p",{children:"Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ø£Ù†Ùƒ ØªØ±ÙŠØ¯ Ø¥Ø²Ø§Ù„Ø© Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬ Ù…Ù† Ø§Ù„Ø³Ù„Ø©ØŸ"}),e.jsxs(ee,{children:[e.jsx(l,{variant:"destructive",onClick:$,children:"Ù†Ø¹Ù…ØŒ Ø¥Ø²Ø§Ù„Ø©"}),e.jsx(l,{variant:"outline",onClick:()=>g(!1),children:"Ø¥Ù„ØºØ§Ø¡"})]})]})]})]})]},s.id))})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"sticky top-4 space-y-4",children:[e.jsxs(C,{children:[e.jsx(k,{children:e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(T,{className:"h-5 w-5"}),"ÙƒÙˆØ¯ Ø§Ù„Ø®ØµÙ…"]})}),e.jsx(S,{children:e.jsx(ne,{cartTotal:r,onCouponApplied:E,onCouponRemoved:Q,appliedCoupon:i})})]}),e.jsxs(C,{children:[e.jsx(k,{children:e.jsx(w,{children:"Ù…Ù„Ø®Øµ Ø§Ù„Ø·Ù„Ø¨"})}),e.jsxs(S,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ"}),e.jsxs("span",{children:[r.toLocaleString()," Ø¬.Ù…"]})]}),I>0&&e.jsxs("div",{className:"flex justify-between text-sm text-green-600 dark:text-green-400",children:[e.jsx("span",{children:"ÙˆÙØ±Øª"}),e.jsxs("span",{children:["- ",I.toLocaleString()," Ø¬.Ù…"]})]}),i&&d>0&&e.jsxs("div",{className:"flex justify-between text-sm text-green-600 dark:text-green-400",children:[e.jsxs("span",{children:["Ø®ØµÙ… Ø§Ù„ÙƒÙˆØ¯ (",i.code,")"]}),e.jsxs("span",{children:["- ",d.toLocaleString()," Ø¬.Ù…"]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(se,{className:"h-4 w-4"}),e.jsx("span",{className:"text-muted-foreground",children:"Ø§Ù„Ø´Ø­Ù†"})]}),e.jsx("span",{className:f===0?"text-green-600 dark:text-green-400":"",children:f===0?"Ù…Ø¬Ø§Ù†ÙŠ":`${f} Ø¬.Ù…`})]}),N<500&&e.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-950 rounded-lg text-xs text-blue-700 dark:text-blue-300",children:[e.jsx(ae,{className:"h-4 w-4 inline-block ml-1"}),"Ø§Ø´ØªØ±Ù Ø¨Ù€ ",(500-N).toLocaleString()," Ø¬.Ù… Ø¥Ø¶Ø§ÙÙŠØ© Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø´Ø­Ù† Ù…Ø¬Ø§Ù†ÙŠ!"]})]}),e.jsx(A,{}),e.jsxs("div",{className:"flex justify-between text-lg font-bold",children:[e.jsx("span",{children:"Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ"}),e.jsxs("span",{className:"text-primary",children:[F.toLocaleString()," Ø¬.Ù…"]})]}),e.jsx(l,{size:"lg",className:"w-full",asChild:!0,children:e.jsxs(j,{to:"/checkout",children:["Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø·Ù„Ø¨",e.jsx(L,{className:"mr-2 h-5 w-5 rtl:mr-0 rtl:ml-2 rtl:rotate-180"})]})}),e.jsx(l,{variant:"outline",size:"lg",className:"w-full",asChild:!0,children:e.jsx(j,{to:"/products",children:"Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„ØªØ³ÙˆÙ‚"})})]})]})]})})]})]})})}export{xe as default};
