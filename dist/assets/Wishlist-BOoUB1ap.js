import{W as v,m as y,Y as b,r as w,j as s,ab as d,a6 as c,o as C,a$ as k}from"./vendor-react-wP-gPk8e.js";import{o as q,a as F,u as P,q as x,C as m,f as h,e as l,g as p,B as n,E as u}from"./index-D1ZXSrVW.js";import{S}from"./SEO-Cuhwwcu-.js";import{P as $}from"./loading-screen-CDFNHjLA.js";import"./vendor-ui-BA32w1ww.js";import"./vendor-query-GexG3wnZ.js";import"./vendor-other-DcnDEVts.js";import"./vendor-animations-W1Z2cmit.js";import"./vendor-appwrite-BGb_FC-V.js";function M(){const{user:t}=q(),{addItem:g}=F(),{toast:r}=P(),j=v(),{data:i=[],isLoading:f}=y({queryKey:x.wishlist((t==null?void 0:t.$id)||""),queryFn:()=>u.getUserWishlist((t==null?void 0:t.$id)||""),enabled:!!(t!=null&&t.$id)}),o=b({mutationFn:({id:e})=>u.removeFromWishlist(e,(t==null?void 0:t.$id)||""),onSuccess:()=>{j.invalidateQueries({queryKey:x.wishlist((t==null?void 0:t.$id)||"")}),r({title:"تم الحذف",description:"تم حذف المنتج من قائمة المفضلة"})},onError:e=>{r({title:"خطأ",description:e.message||"فشل في حذف المنتج",variant:"destructive"})}}),N=e=>{var a;g({productId:e.id,name:e.name,price:e.price,image:p((a=e.images)==null?void 0:a[0]),quantity:1,stockQuantity:e.stockQuantity||e.stock||0,inStock:e.inStock??e.isActive??!0}),r({title:"تم الإضافة",description:"تم إضافة المنتج إلى السلة"})};return w.useEffect(()=>{t||(window.location.href="/login")},[t]),t?f?s.jsx($,{message:"جاري تحميل قائمة المفضلة..."}):s.jsxs(s.Fragment,{children:[s.jsx(S,{title:"قائمة المفضلة",description:"عرض وإدارة المنتجات المفضلة لديك"}),s.jsxs("div",{className:"container mx-auto px-4 py-8",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx(d,{className:"h-8 w-8 text-accent fill-accent"}),s.jsx("h1",{className:"text-3xl font-bold",children:"قائمة المفضلة"})]}),s.jsxs("p",{className:"text-muted-foreground",children:["لديك ",i.length," ",i.length===1?"منتج":"منتجات"," في قائمة المفضلة"]})]}),i.length===0?s.jsx(m,{children:s.jsx(h,{className:"py-16",children:s.jsxs("div",{className:"text-center",children:[s.jsx(d,{className:"mx-auto h-16 w-16 text-muted"}),s.jsx("h3",{className:"mt-4 text-xl font-semibold",children:"قائمة المفضلة فارغة"}),s.jsx("p",{className:"mt-2 text-muted-foreground",children:"لم تقم بإضافة أي منتجات إلى قائمة المفضلة بعد"}),s.jsx(c,{to:"/products",children:s.jsx(l,{className:"mt-6 btn-hover-lift",children:"تصفح المنتجات"})})]})})}):s.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:i.map(e=>{var a;return s.jsx(m,{className:"card-hover group",children:s.jsxs(h,{className:"p-4",children:[s.jsx(c,{to:`/products/${e.productId}`,children:s.jsxs("div",{className:"relative aspect-square mb-4 rounded-lg overflow-hidden bg-gray-100",children:[s.jsx("img",{src:p((a=e.product.images)==null?void 0:a[0]),alt:e.product.name,className:"w-full h-full object-cover group-hover:scale-105 transition-transform"}),!e.product.inStock&&s.jsx("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center",children:s.jsx(n,{variant:"destructive",children:"غير متوفر"})}),e.product.originalPrice&&s.jsxs(n,{className:"absolute top-2 left-2 bg-red-500",children:["خصم ",Math.round((e.product.originalPrice-e.product.price)/e.product.originalPrice*100),"%"]})]})}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(c,{to:`/products/${e.productId}`,children:s.jsx("h3",{className:"font-semibold text-lg line-clamp-2 hover:text-primary",children:e.product.name})}),e.product.category&&s.jsx(n,{variant:"outline",className:"text-xs",children:e.product.category.name}),e.product.rating>0&&s.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[s.jsx("span",{className:"text-yellow-500",children:"★"}),s.jsx("span",{className:"font-medium",children:e.product.rating.toFixed(1)}),s.jsxs("span",{className:"text-gray-500",children:["(",e.product.reviewCount,")"]})]}),s.jsxs("div",{className:"flex items-baseline gap-2",children:[s.jsxs("span",{className:"text-2xl font-bold text-primary",children:[e.product.price.toFixed(2)," جنيه"]}),e.product.originalPrice&&s.jsxs("span",{className:"text-sm text-gray-500 line-through",children:[e.product.originalPrice.toFixed(2)," جنيه"]})]}),s.jsxs("div",{className:"flex gap-2 pt-2",children:[s.jsxs(l,{onClick:()=>N(e.product),disabled:!e.product.inStock,className:"flex-1 btn-hover-lift",children:[s.jsx(C,{className:"h-4 w-4 ml-2"}),"أضف للسلة"]}),s.jsx(l,{variant:"outline",size:"icon",onClick:()=>o.mutate({id:e.id}),disabled:o.isPending,children:s.jsx(k,{className:"h-4 w-4 text-red-500"})})]})]})]})},e.id)})})]})]}):null}export{M as default};
