import{af as K,w as B,p as M,r as S,y as E,j as e,C as i,g as n,B as C,e as r,f as d,N as F,J as _,ab as q,a2 as P,a3 as W,a4 as h,a5 as j,a6 as u,a as k,an as G,a8 as H,a0 as w}from"./index-Ce-RwxJS.js";import{T as Q}from"./target-CDawgCx5.js";import{R as f,b as X,C as A,X as D,Y as x,T as p,L,c as v,B as Y,a as g,P as z,d as J,e as V}from"./PieChart-Bo3gzuJc.js";/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],I=K("activity",O),U="";function ie(){const{user:c}=B(),y=M(),[Z,ee]=S.useState("7days"),{data:l=[],isLoading:R}=E({queryKey:["affiliate-links",c?.$id],queryFn:async()=>c?.$id?(await H.listDocuments(U,"affiliate_links",[w.equal("affiliateId",c.$id),w.orderDesc("$createdAt")])).documents:[],enabled:!!c?.$id}),a={totalClicks:l.reduce((s,t)=>s+(t.clicks||0),0),totalConversions:l.reduce((s,t)=>s+(t.conversions||0),0),totalRevenue:l.reduce((s,t)=>s+(t.revenue||0),0),totalLinks:l.length,avgConversionRate:l.length>0?(l.reduce((s,t)=>{const o=t.clicks>0?t.conversions/t.clicks*100:0;return s+o},0)/l.length).toFixed(2):"0.00"},T=()=>{const s=[],t=new Date;for(let o=6;o>=0;o--){const m=new Date(t);m.setDate(m.getDate()-o);const $=m.toLocaleDateString("ar-EG",{month:"short",day:"numeric"});s.push({date:$,clicks:Math.floor(Math.random()*50)+10,conversions:Math.floor(Math.random()*10),revenue:Math.floor(Math.random()*500)+100})}return s},N=[...l].sort((s,t)=>(t.revenue||0)-(s.revenue||0)).slice(0,5).map(s=>({linkCode:s.linkCode,clicks:s.clicks||0,conversions:s.conversions||0,revenue:s.revenue||0})),b=[{name:"النقرات",value:a.totalClicks,fill:"#f97316"},{name:"التحويلات",value:a.totalConversions,fill:"#10b981"}];return c?.isAffiliate?R?e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"text-center py-12",children:"جاري التحميل..."})}):e.jsxs("div",{className:"container mx-auto px-4 py-8 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"لوحة التحليلات"}),e.jsx("p",{className:"text-muted-foreground",children:"تابع أداء حملاتك التسويقية بالتفصيل"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(i,{children:[e.jsx(r,{className:"pb-2",children:e.jsxs(d,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(F,{className:"h-4 w-4"}),"إجمالي النقرات"]})}),e.jsxs(n,{children:[e.jsx("div",{className:"text-3xl font-bold",children:a.totalClicks}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["من ",a.totalLinks," رابط نشط"]})]})]}),e.jsxs(i,{children:[e.jsx(r,{className:"pb-2",children:e.jsxs(d,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(_,{className:"h-4 w-4"}),"إجمالي التحويلات"]})}),e.jsxs(n,{children:[e.jsx("div",{className:"text-3xl font-bold text-green-600",children:a.totalConversions}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["معدل التحويل ",a.avgConversionRate,"%"]})]})]}),e.jsxs(i,{children:[e.jsx(r,{className:"pb-2",children:e.jsxs(d,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(q,{className:"h-4 w-4"}),"إجمالي العمولات"]})}),e.jsxs(n,{children:[e.jsxs("div",{className:"text-3xl font-bold text-primary",children:[a.totalRevenue.toFixed(2)," جنيه"]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["متوسط ",(a.totalRevenue/(a.totalConversions||1)).toFixed(2)," لكل تحويل"]})]})]}),e.jsxs(i,{children:[e.jsx(r,{className:"pb-2",children:e.jsxs(d,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(Q,{className:"h-4 w-4"}),"معدل التحويل"]})}),e.jsxs(n,{children:[e.jsxs("div",{className:"text-3xl font-bold",children:[a.avgConversionRate,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"متوسط جميع الروابط"})]})]})]}),e.jsxs(P,{defaultValue:"performance",className:"space-y-4",children:[e.jsxs(W,{children:[e.jsx(h,{value:"performance",children:"الأداء اليومي"}),e.jsx(h,{value:"top-links",children:"أفضل الروابط"}),e.jsx(h,{value:"funnel",children:"مسار التحويل"})]}),e.jsx(j,{value:"performance",children:e.jsxs(i,{children:[e.jsxs(r,{children:[e.jsx(d,{children:"الأداء اليومي - آخر 7 أيام"}),e.jsx(u,{children:"تتبع النقرات والتحويلات والعمولات يومياً"})]}),e.jsx(n,{children:e.jsx(f,{width:"100%",height:400,children:e.jsxs(X,{data:T(),children:[e.jsx(A,{strokeDasharray:"3 3"}),e.jsx(D,{dataKey:"date"}),e.jsx(x,{yAxisId:"left"}),e.jsx(x,{yAxisId:"right",orientation:"right"}),e.jsx(p,{}),e.jsx(L,{}),e.jsx(v,{yAxisId:"left",type:"monotone",dataKey:"clicks",stroke:"#f97316",strokeWidth:2,name:"النقرات"}),e.jsx(v,{yAxisId:"left",type:"monotone",dataKey:"conversions",stroke:"#10b981",strokeWidth:2,name:"التحويلات"}),e.jsx(v,{yAxisId:"right",type:"monotone",dataKey:"revenue",stroke:"#3b82f6",strokeWidth:2,name:"العمولة (جنيه)"})]})})})]})}),e.jsx(j,{value:"top-links",children:e.jsxs(i,{children:[e.jsxs(r,{children:[e.jsx(d,{children:"أفضل 5 روابط أداءً"}),e.jsx(u,{children:"الروابط التي حققت أعلى عمولات"})]}),e.jsx(n,{children:N.length===0?e.jsx("div",{className:"text-center py-12 text-muted-foreground",children:"لا توجد بيانات كافية لعرض الرسم البياني"}):e.jsx(f,{width:"100%",height:400,children:e.jsxs(Y,{data:N,children:[e.jsx(A,{strokeDasharray:"3 3"}),e.jsx(D,{dataKey:"linkCode"}),e.jsx(x,{yAxisId:"left"}),e.jsx(x,{yAxisId:"right",orientation:"right"}),e.jsx(p,{}),e.jsx(L,{}),e.jsx(g,{yAxisId:"left",dataKey:"clicks",fill:"#f97316",name:"النقرات"}),e.jsx(g,{yAxisId:"left",dataKey:"conversions",fill:"#10b981",name:"التحويلات"}),e.jsx(g,{yAxisId:"right",dataKey:"revenue",fill:"#3b82f6",name:"العمولة"})]})})})]})}),e.jsx(j,{value:"funnel",children:e.jsxs(i,{children:[e.jsxs(r,{children:[e.jsx(d,{children:"مسار التحويل"}),e.jsx(u,{children:"تحليل رحلة العميل من النقرة إلى الشراء"})]}),e.jsx(n,{children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[e.jsx("div",{children:e.jsx(f,{width:"100%",height:300,children:e.jsxs(z,{children:[e.jsx(J,{data:b,cx:"50%",cy:"50%",labelLine:!1,label:({name:s,value:t})=>`${s}: ${t}`,outerRadius:100,dataKey:"value",children:b.map((s,t)=>e.jsx(V,{fill:s.fill},`cell-${t}`))}),e.jsx(p,{})]})})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"النقرات"}),e.jsx(k,{variant:"outline",children:a.totalClicks})]}),e.jsx("div",{className:"h-2 bg-muted rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-orange-500",style:{width:"100%"}})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"التحويلات"}),e.jsx(k,{variant:"outline",children:a.totalConversions})]}),e.jsx("div",{className:"h-2 bg-muted rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-green-500",style:{width:`${a.totalClicks>0?a.totalConversions/a.totalClicks*100:0}%`}})})]}),e.jsxs("div",{className:"pt-4 border-t",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(I,{className:"h-5 w-5 text-primary"}),e.jsx("span",{className:"font-semibold",children:"معدل التحويل"})]}),e.jsxs("div",{className:"text-3xl font-bold text-primary",children:[a.avgConversionRate,"%"]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:a.totalClicks>0?`${a.totalConversions} من ${a.totalClicks} نقرة أصبحت عملية شراء`:"لا توجد بيانات بعد"})]})]})]})})]})})]}),e.jsxs(i,{className:"bg-gradient-to-r from-primary/10 to-orange-500/10 border-primary",children:[e.jsx(r,{children:e.jsxs(d,{className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-5 w-5"}),"نصائح لتحسين الأداء"]})}),e.jsxs(n,{className:"space-y-2",children:[e.jsx("p",{className:"text-sm",children:"• معدل تحويل أعلى من 5% يُعتبر ممتاز - استمر بهذا الأداء!"}),e.jsx("p",{className:"text-sm",children:"• ركز على الروابط ذات الأداء الأفضل وأنشئ المزيد من المحتوى حولها"}),e.jsx("p",{className:"text-sm",children:"• جرب أوقات نشر مختلفة لمعرفة متى يكون جمهورك أكثر نشاطاً"}),e.jsx("p",{className:"text-sm",children:"• استخدم البانرات والأدوات التسويقية لزيادة النقرات"})]})]})]}):e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx(i,{children:e.jsxs(n,{className:"p-12 text-center space-y-4",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(I,{className:"h-8 w-8 text-orange-600"})}),e.jsx("h2",{className:"text-2xl font-bold",children:"هذه الصفحة للمسوقين فقط"}),e.jsx("p",{className:"text-muted-foreground max-w-md mx-auto",children:"يجب أن يكون حسابك مفعّلاً كحساب مسوق للوصول إلى لوحة التحليلات والإحصائيات"}),e.jsxs("div",{className:"flex gap-3 justify-center pt-4",children:[e.jsx(C,{onClick:()=>y("/update-affiliate-prefs"),children:"تفعيل حساب المسوق"}),e.jsx(C,{variant:"outline",onClick:()=>y("/affiliate"),children:"معرفة المزيد"})]})]})})})}export{ie as default};
