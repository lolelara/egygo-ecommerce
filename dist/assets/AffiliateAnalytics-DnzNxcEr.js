import{u as K,r as M,f as B,j as e,bG as C,aq as S,h as E,M as q,bs as F,bb as h,bl as G,bd as k,be as w,bf as x,bg as j,bh as A,bm as f,bj as Q,bk as u,bn as W,bo as P,bp as _,au as H}from"./vendor-react-BTCGZZAN.js";import{o as V,C as l,f as n,e as D,r as d,s as c,G as p,B as I,d as X}from"./index-DAwEpow4.js";import{Q as R}from"./vendor-appwrite-BQhTxLk4.js";import{T as Y,a as z,b as v,c as g}from"./tabs-43GTZMZA.js";import"./vendor-ui-BA32w1ww.js";import"./vendor-query-GexG3wnZ.js";import"./vendor-other-ws_0vYaO.js";import"./vendor-animations-W1Z2cmit.js";const J="";function re(){const{user:i}=V(),y=K(),[O,U]=M.useState("7days"),{data:r=[],isLoading:L}=B({queryKey:["affiliate-links",i==null?void 0:i.$id],queryFn:async()=>i!=null&&i.$id?(await X.listDocuments(J,"affiliate_links",[R.equal("affiliateId",i.$id),R.orderDesc("$createdAt")])).documents:[],enabled:!!(i!=null&&i.$id)}),t={totalClicks:r.reduce((s,a)=>s+(a.clicks||0),0),totalConversions:r.reduce((s,a)=>s+(a.conversions||0),0),totalRevenue:r.reduce((s,a)=>s+(a.revenue||0),0),totalLinks:r.length,avgConversionRate:r.length>0?(r.reduce((s,a)=>{const o=a.clicks>0?a.conversions/a.clicks*100:0;return s+o},0)/r.length).toFixed(2):"0.00"},T=()=>{const s=[],a=new Date;for(let o=6;o>=0;o--){const m=new Date(a);m.setDate(m.getDate()-o);const $=m.toLocaleDateString("ar-EG",{month:"short",day:"numeric"});s.push({date:$,clicks:Math.floor(Math.random()*50)+10,conversions:Math.floor(Math.random()*10),revenue:Math.floor(Math.random()*500)+100})}return s},N=[...r].sort((s,a)=>(a.revenue||0)-(s.revenue||0)).slice(0,5).map(s=>({linkCode:s.linkCode,clicks:s.clicks||0,conversions:s.conversions||0,revenue:s.revenue||0})),b=[{name:"النقرات",value:t.totalClicks,fill:"#f97316"},{name:"التحويلات",value:t.totalConversions,fill:"#10b981"}];return i!=null&&i.isAffiliate?L?e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"text-center py-12",children:"جاري التحميل..."})}):e.jsxs("div",{className:"container mx-auto px-4 py-8 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"لوحة التحليلات"}),e.jsx("p",{className:"text-muted-foreground",children:"تابع أداء حملاتك التسويقية بالتفصيل"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(l,{children:[e.jsx(d,{className:"pb-2",children:e.jsxs(c,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(S,{className:"h-4 w-4"}),"إجمالي النقرات"]})}),e.jsxs(n,{children:[e.jsx("div",{className:"text-3xl font-bold",children:t.totalClicks}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["من ",t.totalLinks," رابط نشط"]})]})]}),e.jsxs(l,{children:[e.jsx(d,{className:"pb-2",children:e.jsxs(c,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(E,{className:"h-4 w-4"}),"إجمالي التحويلات"]})}),e.jsxs(n,{children:[e.jsx("div",{className:"text-3xl font-bold text-green-600",children:t.totalConversions}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["معدل التحويل ",t.avgConversionRate,"%"]})]})]}),e.jsxs(l,{children:[e.jsx(d,{className:"pb-2",children:e.jsxs(c,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(q,{className:"h-4 w-4"}),"إجمالي العمولات"]})}),e.jsxs(n,{children:[e.jsxs("div",{className:"text-3xl font-bold text-primary",children:[t.totalRevenue.toFixed(2)," جنيه"]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["متوسط ",(t.totalRevenue/(t.totalConversions||1)).toFixed(2)," لكل تحويل"]})]})]}),e.jsxs(l,{children:[e.jsx(d,{className:"pb-2",children:e.jsxs(c,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(F,{className:"h-4 w-4"}),"معدل التحويل"]})}),e.jsxs(n,{children:[e.jsxs("div",{className:"text-3xl font-bold",children:[t.avgConversionRate,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"متوسط جميع الروابط"})]})]})]}),e.jsxs(Y,{defaultValue:"performance",className:"space-y-4",children:[e.jsxs(z,{children:[e.jsx(v,{value:"performance",children:"الأداء اليومي"}),e.jsx(v,{value:"top-links",children:"أفضل الروابط"}),e.jsx(v,{value:"funnel",children:"مسار التحويل"})]}),e.jsx(g,{value:"performance",children:e.jsxs(l,{children:[e.jsxs(d,{children:[e.jsx(c,{children:"الأداء اليومي - آخر 7 أيام"}),e.jsx(p,{children:"تتبع النقرات والتحويلات والعمولات يومياً"})]}),e.jsx(n,{children:e.jsx(h,{width:"100%",height:400,children:e.jsxs(G,{data:T(),children:[e.jsx(k,{strokeDasharray:"3 3"}),e.jsx(w,{dataKey:"date"}),e.jsx(x,{yAxisId:"left"}),e.jsx(x,{yAxisId:"right",orientation:"right"}),e.jsx(j,{}),e.jsx(A,{}),e.jsx(f,{yAxisId:"left",type:"monotone",dataKey:"clicks",stroke:"#f97316",strokeWidth:2,name:"النقرات"}),e.jsx(f,{yAxisId:"left",type:"monotone",dataKey:"conversions",stroke:"#10b981",strokeWidth:2,name:"التحويلات"}),e.jsx(f,{yAxisId:"right",type:"monotone",dataKey:"revenue",stroke:"#3b82f6",strokeWidth:2,name:"العمولة (جنيه)"})]})})})]})}),e.jsx(g,{value:"top-links",children:e.jsxs(l,{children:[e.jsxs(d,{children:[e.jsx(c,{children:"أفضل 5 روابط أداءً"}),e.jsx(p,{children:"الروابط التي حققت أعلى عمولات"})]}),e.jsx(n,{children:N.length===0?e.jsx("div",{className:"text-center py-12 text-muted-foreground",children:"لا توجد بيانات كافية لعرض الرسم البياني"}):e.jsx(h,{width:"100%",height:400,children:e.jsxs(Q,{data:N,children:[e.jsx(k,{strokeDasharray:"3 3"}),e.jsx(w,{dataKey:"linkCode"}),e.jsx(x,{yAxisId:"left"}),e.jsx(x,{yAxisId:"right",orientation:"right"}),e.jsx(j,{}),e.jsx(A,{}),e.jsx(u,{yAxisId:"left",dataKey:"clicks",fill:"#f97316",name:"النقرات"}),e.jsx(u,{yAxisId:"left",dataKey:"conversions",fill:"#10b981",name:"التحويلات"}),e.jsx(u,{yAxisId:"right",dataKey:"revenue",fill:"#3b82f6",name:"العمولة"})]})})})]})}),e.jsx(g,{value:"funnel",children:e.jsxs(l,{children:[e.jsxs(d,{children:[e.jsx(c,{children:"مسار التحويل"}),e.jsx(p,{children:"تحليل رحلة العميل من النقرة إلى الشراء"})]}),e.jsx(n,{children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[e.jsx("div",{children:e.jsx(h,{width:"100%",height:300,children:e.jsxs(W,{children:[e.jsx(P,{data:b,cx:"50%",cy:"50%",labelLine:!1,label:({name:s,value:a})=>`${s}: ${a}`,outerRadius:100,dataKey:"value",children:b.map((s,a)=>e.jsx(_,{fill:s.fill},`cell-${a}`))}),e.jsx(j,{})]})})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"النقرات"}),e.jsx(I,{variant:"outline",children:t.totalClicks})]}),e.jsx("div",{className:"h-2 bg-muted rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-orange-500",style:{width:"100%"}})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"التحويلات"}),e.jsx(I,{variant:"outline",children:t.totalConversions})]}),e.jsx("div",{className:"h-2 bg-muted rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-green-500",style:{width:`${t.totalClicks>0?t.totalConversions/t.totalClicks*100:0}%`}})})]}),e.jsxs("div",{className:"pt-4 border-t",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(C,{className:"h-5 w-5 text-primary"}),e.jsx("span",{className:"font-semibold",children:"معدل التحويل"})]}),e.jsxs("div",{className:"text-3xl font-bold text-primary",children:[t.avgConversionRate,"%"]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:t.totalClicks>0?`${t.totalConversions} من ${t.totalClicks} نقرة أصبحت عملية شراء`:"لا توجد بيانات بعد"})]})]})]})})]})})]}),e.jsxs(l,{className:"bg-gradient-to-r from-primary/10 to-orange-500/10 border-primary",children:[e.jsx(d,{children:e.jsxs(c,{className:"flex items-center gap-2",children:[e.jsx(H,{className:"h-5 w-5"}),"نصائح لتحسين الأداء"]})}),e.jsxs(n,{className:"space-y-2",children:[e.jsx("p",{className:"text-sm",children:"• معدل تحويل أعلى من 5% يُعتبر ممتاز - استمر بهذا الأداء!"}),e.jsx("p",{className:"text-sm",children:"• ركز على الروابط ذات الأداء الأفضل وأنشئ المزيد من المحتوى حولها"}),e.jsx("p",{className:"text-sm",children:"• جرب أوقات نشر مختلفة لمعرفة متى يكون جمهورك أكثر نشاطاً"}),e.jsx("p",{className:"text-sm",children:"• استخدم البانرات والأدوات التسويقية لزيادة النقرات"})]})]})]}):e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx(l,{children:e.jsxs(n,{className:"p-12 text-center space-y-4",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(C,{className:"h-8 w-8 text-orange-600"})}),e.jsx("h2",{className:"text-2xl font-bold",children:"هذه الصفحة للمسوقين فقط"}),e.jsx("p",{className:"text-muted-foreground max-w-md mx-auto",children:"يجب أن يكون حسابك مفعّلاً كحساب مسوق للوصول إلى لوحة التحليلات والإحصائيات"}),e.jsxs("div",{className:"flex gap-3 justify-center pt-4",children:[e.jsx(D,{onClick:()=>y("/update-affiliate-prefs"),children:"تفعيل حساب المسوق"}),e.jsx(D,{variant:"outline",onClick:()=>y("/affiliate"),children:"معرفة المزيد"})]})]})})})}export{re as default};
