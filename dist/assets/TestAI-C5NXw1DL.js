import{r as i,j as s,ae as b,b9 as f,b8 as E}from"./vendor-react-wP-gPk8e.js";import{C as v,r as y,s as _,f as K,J as a,K as l,e as O}from"./index-BjwBfcA6.js";import{e}from"./env-B8jD6Wsc.js";import"./vendor-ui-BA32w1ww.js";import"./vendor-query-GexG3wnZ.js";import"./vendor-other-DcnDEVts.js";import"./vendor-animations-W1Z2cmit.js";import"./vendor-appwrite-BGb_FC-V.js";function D(){var m,h,j,p;const[o,c]=i.useState(!1),[r,d]=i.useState(null),[t,x]=i.useState(""),P=async()=>{var g,N,u;c(!0),x(""),d(null);try{console.log("🔍 Testing OpenAI API..."),console.log("API Key present:",!!e.OPENAI_API_KEY),console.log("API Key length:",(g=e.OPENAI_API_KEY)==null?void 0:g.length),console.log("API Key preview:",((N=e.OPENAI_API_KEY)==null?void 0:N.substring(0,15))+"...");const n=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.OPENAI_API_KEY}`},body:JSON.stringify({model:"gpt-3.5-turbo",messages:[{role:"user",content:"قل مرحباً بالعربية"}],max_tokens:50})});if(console.log("Response status:",n.status),!n.ok){const I=await n.json();throw console.error("API Error:",I),new Error(((u=I.error)==null?void 0:u.message)||`HTTP ${n.status}`)}const A=await n.json();console.log("API Response:",A),d(A)}catch(n){console.error("Test failed:",n),x(n.message)}finally{c(!1)}};return s.jsx("div",{className:"container mx-auto py-8 px-4 max-w-4xl",children:s.jsxs(v,{children:[s.jsx(y,{children:s.jsx(_,{children:"🧪 اختبار OpenAI API"})}),s.jsxs(K,{className:"space-y-4",children:[s.jsx(a,{children:s.jsx(l,{children:s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"font-semibold",children:"حالة API Key:"}),s.jsx("span",{className:e.OPENAI_API_KEY?"text-green-600":"text-red-600",children:e.OPENAI_API_KEY?"✅ موجود":"❌ غير موجود"})]}),e.OPENAI_API_KEY&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"font-semibold",children:"الطول:"}),s.jsxs("span",{children:[e.OPENAI_API_KEY.length," حرف"]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"font-semibold",children:"المعاينة:"}),s.jsxs("span",{className:"font-mono text-xs",children:[e.OPENAI_API_KEY.substring(0,20),"..."]})]})]})]})})}),s.jsx(O,{onClick:P,disabled:o||!e.OPENAI_API_KEY,className:"w-full",size:"lg",children:o?s.jsxs(s.Fragment,{children:[s.jsx(b,{className:"mr-2 h-4 w-4 animate-spin"}),"جاري الاختبار..."]}):"🚀 اختبار API"}),t&&s.jsxs(a,{variant:"destructive",children:[s.jsx(f,{className:"h-4 w-4"}),s.jsxs(l,{children:[s.jsx("div",{className:"font-semibold mb-2",children:"❌ فشل الاختبار"}),s.jsx("div",{className:"text-sm font-mono bg-red-50 p-2 rounded",children:t})]})]}),r&&!t&&s.jsxs(a,{className:"bg-green-50 border-green-200",children:[s.jsx(E,{className:"h-4 w-4 text-green-600"}),s.jsxs(l,{children:[s.jsx("div",{className:"font-semibold mb-2 text-green-900",children:"✅ نجح الاختبار!"}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"font-semibold",children:"الرسالة:"}),s.jsx("div",{className:"bg-white p-2 rounded mt-1 border",children:((j=(h=(m=r.choices)==null?void 0:m[0])==null?void 0:h.message)==null?void 0:j.content)||"لا يوجد محتوى"})]}),s.jsxs("div",{className:"text-xs text-gray-600",children:[s.jsxs("div",{children:["Model: ",r.model]}),s.jsxs("div",{children:["Tokens used: ",(p=r.usage)==null?void 0:p.total_tokens]})]})]})]})]}),s.jsx(a,{children:s.jsxs(l,{className:"text-sm",children:[s.jsx("div",{className:"font-semibold mb-2",children:"📝 ملاحظات:"}),s.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[s.jsxs("li",{children:["تأكد من وجود ملف ",s.jsx("code",{className:"bg-gray-100 px-1 rounded",children:".env"})]}),s.jsxs("li",{children:["تأكد من صحة المتغير: ",s.jsx("code",{className:"bg-gray-100 px-1 rounded",children:"VITE_OPENAI_API_KEY"})]}),s.jsxs("li",{children:["تأكد من أن API Key يبدأ بـ ",s.jsx("code",{className:"bg-gray-100 px-1 rounded",children:"sk-"})]}),s.jsxs("li",{children:["أعد تشغيل السيرفر بعد تعديل ",s.jsx("code",{className:"bg-gray-100 px-1 rounded",children:".env"})]})]})]})}),s.jsxs("div",{className:"mt-4 p-3 bg-gray-900 text-gray-100 rounded-lg text-xs font-mono",children:[s.jsx("div",{className:"text-green-400 mb-1",children:"Console Output:"}),s.jsx("div",{children:"افتح Developer Console (F12) لرؤية التفاصيل"})]})]})]})})}export{D as default};
