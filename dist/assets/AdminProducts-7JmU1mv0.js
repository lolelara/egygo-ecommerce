import{r as f,j as e,af as se,c1 as ae,X as ie,bR as ce,bX as oe,a0 as de,bp as me,n as xe,p as H,c0 as he,k as ge,c2 as je,aZ as ue}from"./vendor-react-CCFRLLzk.js";import{A as Q}from"./AdminLayout-C-VSnXvz.js";import{a2 as $,u as fe,f as z,C as T,J as ve,B as R,a0 as pe,e as V,c as Ne,D as W,N as X,z as G,A as Z,E as _,F as K,x as E,y as B,h as L,I as k,S as te,i as re,j as le,k as ne,l as J,g as ye,w as be,t as we,L as C,T as Ce,G as Pe}from"./index-CtsYZAzS.js";import{T as Se,a as ke,b as Y,c as A,d as Ie,e as D}from"./table-DM4QjHXT.js";import{I as ze}from"./vendor-appwrite-CuqfvTq9.js";import{P as Fe}from"./progress-CYuOOZOb.js";import{P as Ae}from"./loading-screen-mNgkYjLx.js";import{a as O}from"./admin-api-pmR1cZ6X.js";import"./vendor-ui-BA32w1ww.js";import"./vendor-query-j_rPqiug.js";import"./vendor-other-CzBBjgu5.js";import"./vendor-animations-CPHPqPXb.js";import"./avatar-Glpu3gcq.js";import"./appwrite-client-DFce-dPK.js";function De({value:s=[],onChange:v,maxFiles:p=5,disabled:y=!1}){const[r,m]=f.useState(!1),[d,N]=f.useState(s.map(x=>({url:x,fileId:$.extractFileId(x)||void 0}))),P=f.useRef(null),{toast:j}=fe(),S=async x=>{const c=Array.from(x.target.files||[]);if(c.length===0)return;if(d.length+c.length>p){j({title:"ØªØ­Ø°ÙŠØ±",description:`ÙŠÙ…ÙƒÙ†Ùƒ Ø±ÙØ¹ ${p} ØµÙˆØ± ÙƒØ­Ø¯ Ø£Ù‚ØµÙ‰`,variant:"destructive"});return}const a=$.validateFiles(c);if(!a.valid){j({title:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…Ù„ÙØ§Øª",description:a.errors.join(`
`),variant:"destructive"});return}m(!0);try{const t=await $.uploadFiles(c),h=t.map(g=>({url:g.url,fileId:g.fileId})),u=[...d,...h];N(u),v(u.map(g=>g.url)),j({title:"ØªÙ… Ø§Ù„Ø±ÙØ¹ Ø¨Ù†Ø¬Ø§Ø­",description:`ØªÙ… Ø±ÙØ¹ ${t.length} ØµÙˆØ±Ø© Ø¨Ù†Ø¬Ø§Ø­`})}catch(t){j({title:"ÙØ´Ù„ Ø§Ù„Ø±ÙØ¹",description:t.message||"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±",variant:"destructive"})}finally{m(!1),P.current&&(P.current.value="")}},I=async x=>{const c=d[x];if(c.fileId)try{await $.deleteFile(c.fileId)}catch(t){console.error("Failed to delete file:",t)}const a=d.filter((t,h)=>h!==x);N(a),v(a.map(t=>t.url)),j({title:"ØªÙ… Ø§Ù„Ø­Ø°Ù",description:"ØªÙ… Ø­Ø°Ù Ø§Ù„ØµÙˆØ±Ø© Ø¨Ù†Ø¬Ø§Ø­"})};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("input",{ref:P,type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp",multiple:!0,onChange:S,disabled:y||r||d.length>=p,className:"hidden"}),e.jsx(z,{type:"button",variant:"outline",onClick:()=>{var x;return(x=P.current)==null?void 0:x.click()},disabled:y||r||d.length>=p,className:"w-full",children:r?e.jsxs(e.Fragment,{children:[e.jsx(se,{className:"ml-2 h-4 w-4 animate-spin"}),"Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø±ÙØ¹..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ae,{className:"ml-2 h-4 w-4"}),"Ø±ÙØ¹ ØµÙˆØ± (",d.length,"/",p,")"]})}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰: ",p," ØµÙˆØ±ØŒ 5 Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª Ù„ÙƒÙ„ ØµÙˆØ±Ø© (JPG, PNG, WEBP)"]})]}),d.length>0&&e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4",children:d.map((x,c)=>e.jsx(T,{className:"relative group",children:e.jsxs("div",{className:"aspect-square",children:[e.jsx("img",{src:x.url,alt:`ØµÙˆØ±Ø© ${c+1}`,className:"w-full h-full object-cover rounded-lg",onError:a=>{a.currentTarget.src=ve.product()}}),c===0&&e.jsx(R,{className:"absolute top-2 left-2 bg-primary",children:"Ø±Ø¦ÙŠØ³ÙŠØ©"}),e.jsx(z,{type:"button",variant:"destructive",size:"icon",className:"absolute top-2 right-2 h-8 w-8 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>I(c),disabled:y||r,children:e.jsx(ie,{className:"h-4 w-4"})})]})},c))}),d.length===0&&!r&&e.jsx(T,{className:"border-dashed",children:e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(ce,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Ù„Ù… ÙŠØªÙ… Ø±ÙØ¹ ØµÙˆØ± Ø¨Ø¹Ø¯"})]})})]})}function Te({value:s,onChange:v,label:p="ÙÙŠØ¯ÙŠÙˆ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ù†ØªØ¬",required:y=!1}){const[r,m]=f.useState(!1),[d,N]=f.useState(0),[P,j]=f.useState(null),S=f.useRef(null),I=async a=>{var u,g,b,i,l;const t=(u=a.target.files)==null?void 0:u[0];if(!t)return;if(!t.type.startsWith("video/")){j("ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù ÙÙŠØ¯ÙŠÙˆ ØµØ­ÙŠØ­");return}const h=50*1024*1024;if(t.size>h){j("Ø­Ø¬Ù… Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£Ù‚Ù„ Ù…Ù† 50 Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª");return}j(null),m(!0),N(0);try{const n=setInterval(()=>{N(w=>w>=90?w:w+10)},300),o=await pe.createFile(V.storageId,ze.unique(),t,void 0,w=>{const q=Math.round(w.$id?100:w.chunksUploaded/w.chunksTotal*100);N(q)});clearInterval(n);const F=`${o.$id}`;v(F),N(100),setTimeout(()=>{N(0),m(!1)},500)}catch(n){console.error("Error uploading video:",n);let o="ÙØ´Ù„ Ø±ÙØ¹ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰";(g=n.message)!=null&&g.includes("extension not allowed")?o="Ù†ÙˆØ¹ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…. Ø§Ø³ØªØ®Ø¯Ù… MP4 Ø£Ùˆ MOV":(b=n.message)!=null&&b.includes("size")?o="Ø­Ø¬Ù… Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ÙƒØ¨ÙŠØ± Ø¬Ø¯Ø§Ù‹. Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ 50 Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª":((i=n.message)!=null&&i.includes("network")||(l=n.message)!=null&&l.includes("timeout"))&&(o="Ù…Ø´ÙƒÙ„Ø© ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„. ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª ÙˆØ­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰"),j(o),m(!1),N(0)}},x=()=>{v(""),S.current&&(S.current.value="")},c=a=>a?a.startsWith("http")?a:`https://cloud.appwrite.io/v1/storage/buckets/${V.storageId}/files/${a}/view?project=${V.projectId}`:"";return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{className:"text-sm font-medium",children:[p,y&&e.jsx("span",{className:"text-red-500 mr-1",children:"*"})]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Ø­Ø¯ Ø£Ù‚ØµÙ‰: 50 Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª"})]}),s?e.jsxs("div",{className:"border rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(oe,{className:"h-5 w-5 text-primary"}),e.jsx("span",{className:"text-sm font-medium",children:"ØªÙ… Ø±ÙØ¹ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ"})]}),e.jsx(z,{type:"button",variant:"ghost",size:"sm",onClick:x,className:"text-red-500 hover:text-red-700 hover:bg-red-50",children:e.jsx(ie,{className:"h-4 w-4"})})]}),e.jsx("video",{src:c(s),controls:!0,className:"w-full rounded-lg max-h-64",children:"Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø¹Ø±Ø¶ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"âœ… ØªÙ… Ø±ÙØ¹ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø¨Ù†Ø¬Ø§Ø­. Ø§Ù„Ù…Ù†ØªØ¬ Ø³ÙŠÙƒÙˆÙ† Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø­ØªÙ‰ ØªØªÙ… Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„ÙŠÙ‡ Ù…Ù† Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©."})]}):e.jsxs("div",{className:`border-2 border-dashed rounded-lg p-6 text-center cursor-pointer transition-colors ${r?"border-primary bg-primary/5":"border-gray-300 hover:border-primary"}`,onClick:()=>{var a;return!r&&((a=S.current)==null?void 0:a.click())},children:[e.jsx("input",{ref:S,type:"file",accept:"video/*",onChange:I,className:"hidden",disabled:r}),r?e.jsxs("div",{className:"space-y-3",children:[e.jsx(se,{className:"h-12 w-12 mx-auto animate-spin text-primary"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Ø¬Ø§Ø±ÙŠ Ø±ÙØ¹ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ..."}),e.jsx(Fe,{value:d,className:"h-2"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[d,"%"]})]})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsx(ae,{className:"h-12 w-12 mx-auto text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Ø§Ø¶ØºØ· Ù„Ø±ÙØ¹ ÙÙŠØ¯ÙŠÙˆ Ø§Ù„ØªØ­Ù‚Ù‚"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"MP4, MOV, AVI, WebM (Ø­Ø¯ Ø£Ù‚ØµÙ‰ 50MB)"})]}),e.jsx("p",{className:"text-xs text-amber-600 bg-amber-50 dark:bg-amber-900/20 p-2 rounded",children:"â„¹ï¸ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙØ¸Ù‡Ø± Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ù…Ù†ØªØ¬ Ø¨ÙˆØ¶ÙˆØ­ Ù…Ø¹ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø°ÙƒÙˆØ±Ø© ÙÙŠ Ø§Ù„ÙˆØµÙ"})]})]}),P&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-red-600 bg-red-50 dark:bg-red-900/20 p-3 rounded",children:[e.jsx(de,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{children:P})]}),e.jsxs("div",{className:"text-xs text-muted-foreground bg-blue-50 dark:bg-blue-900/20 p-3 rounded",children:[e.jsx("p",{className:"font-semibold mb-1",children:"ğŸ“¹ Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„ÙÙŠØ¯ÙŠÙˆ:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"ØªØµÙˆÙŠØ± ÙˆØ§Ø¶Ø­ Ù„Ù„Ù…Ù†ØªØ¬ Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø²ÙˆØ§ÙŠØ§"}),e.jsx("li",{children:"Ø¥Ø¸Ù‡Ø§Ø± Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªÙØ§ØµÙŠÙ„ ÙˆØ§Ù„Ù…ÙˆØ§ØµÙØ§Øª Ø§Ù„Ù…Ø°ÙƒÙˆØ±Ø© ÙÙŠ Ø§Ù„ÙˆØµÙ"}),e.jsx("li",{children:"Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¹Ù„Ø§Ù…Ø© Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ© ÙˆØ§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯ (Ø¥Ù† ÙˆÙØ¬Ø¯)"}),e.jsx("li",{children:"Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø¬ÙˆØ¯Ø© Ø§Ù„ØµÙˆØª ÙˆØ§Ù„ØµÙˆØ±Ø©"}),e.jsx("li",{children:"Ù…Ø¯Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ: 30 Ø«Ø§Ù†ÙŠØ© Ø¥Ù„Ù‰ 3 Ø¯Ù‚Ø§Ø¦Ù‚"})]})]})]})}const ee=({product:s,categories:v,onSubmit:p,onCancel:y})=>{var I,x,c;const[r,m]=f.useState({name:(s==null?void 0:s.name)||"",description:(s==null?void 0:s.description)||"",price:(s==null?void 0:s.price)||0,originalPrice:(s==null?void 0:s.originalPrice)||0,basePrice:(s==null?void 0:s.basePrice)||(s==null?void 0:s.price)||0,minCommissionPrice:(s==null?void 0:s.minCommissionPrice)||(s==null?void 0:s.price)||0,categoryId:(s==null?void 0:s.category)||"",images:(s==null?void 0:s.images)||[],tags:((I=s==null?void 0:s.tags)==null?void 0:I.join(", "))||"",stockQuantity:100,affiliateCommission:(s==null?void 0:s.affiliateCommission)||8,colors:((x=s==null?void 0:s.colors)==null?void 0:x.join(", "))||"",sizes:((c=s==null?void 0:s.sizes)==null?void 0:c.join(", "))||"",verificationVideo:(s==null?void 0:s.verificationVideo)||"",approvalStatus:(s==null?void 0:s.approvalStatus)||"pending"}),[d,N]=f.useState(()=>{try{const a=s==null?void 0:s.colorSizeInventory;return a?JSON.parse(a):[]}catch{return[]}}),P=a=>{a.preventDefault();const t=r.colors.split(",").map(l=>l.trim()).filter(Boolean),h=r.sizes.split(",").map(l=>l.trim()).filter(Boolean),u=[];t.length>0&&h.length>0&&u.push(...d);const g=u.reduce((l,n)=>l+n.quantity,0);console.log("ğŸ“¦ Inventory data being saved:",u),console.log("ğŸ“Š Total stock calculated:",g);const b=g>0?g:r.stockQuantity||100,i={...r,images:r.images,tags:r.tags.split(",").map(l=>l.trim()).filter(Boolean),colors:t,sizes:h,colorSizeInventory:JSON.stringify(u),stock:b,stockQuantity:b,inStock:!0,isActive:!0};console.log("ğŸ’¾ Submit data:",i),p(s?{...i,id:s.id}:i)},j=()=>{const a=r.colors.split(",").map(h=>h.trim()).filter(Boolean),t=r.sizes.split(",").map(h=>h.trim()).filter(Boolean);if(a.length>0&&t.length>0){const h=[];a.forEach(u=>{t.forEach(g=>{const b=d.find(i=>i.color===u&&i.size===g);h.push({color:u,size:g,quantity:(b==null?void 0:b.quantity)||0})})}),N(h)}},S=(a,t,h)=>{N(u=>u.map(g=>g.color===a&&g.size===t?{...g,quantity:Math.max(0,h)}:g))};return e.jsxs("form",{onSubmit:P,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"name",children:"Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬"}),e.jsx(k,{id:"name",value:r.name,onChange:a=>m(t=>({...t,name:a.target.value})),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"category",children:"Ø§Ù„ÙØ¦Ø©"}),e.jsxs(te,{value:r.categoryId,onValueChange:a=>m(t=>({...t,categoryId:a})),children:[e.jsx(re,{children:e.jsx(le,{placeholder:"Ø§Ø®ØªØ± ÙØ¦Ø©"})}),e.jsx(ne,{children:v.map(a=>e.jsx(J,{value:a.id,children:a.name},a.id))})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"description",children:"Ø§Ù„ÙˆØµÙ"}),e.jsx(Ce,{id:"description",value:r.description,onChange:a=>m(t=>({...t,description:a.target.value})),rows:3,required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"price",children:"Ø§Ù„Ø³Ø¹Ø± Ù„Ù„Ø¹Ø±Ø¶ (Ø¬.Ù…)"}),e.jsx(k,{id:"price",type:"number",value:r.price,onChange:a=>m(t=>({...t,price:Number(a.target.value)})),min:"0",step:"0.01",required:!0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø°ÙŠ Ø³ÙŠØ¸Ù‡Ø± Ù„Ù„Ø¹Ù…Ù„Ø§Ø¡"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"originalPrice",children:"Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø£ØµÙ„ÙŠ (Ø¬.Ù…)"}),e.jsx(k,{id:"originalPrice",type:"number",value:r.originalPrice,onChange:a=>m(t=>({...t,originalPrice:Number(a.target.value)})),min:"0",step:"0.01"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Ø§Ù„Ø³Ø¹Ø± Ù‚Ø¨Ù„ Ø§Ù„Ø®ØµÙ… (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h3",{className:"font-semibold mb-3 text-primary",children:"âš™ï¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© Ù„Ù„Ù…Ø³ÙˆÙ‚ÙŠÙ†"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"basePrice",children:"Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ (Ù‚Ø¨Ù„ Ø§Ù„Ø¹Ù…ÙˆÙ„Ø©)"}),e.jsx(k,{id:"basePrice",type:"number",value:r.basePrice,onChange:a=>m(t=>({...t,basePrice:Number(a.target.value)})),min:"0",step:"0.01",required:!0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø°ÙŠ Ø³ØªØ­ØµÙ„ Ø¹Ù„ÙŠÙ‡ (Ø¨Ø¯ÙˆÙ† Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ù…Ø³ÙˆÙ‚)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"minCommissionPrice",children:"Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù„Ù„Ø³Ø¹Ø± (Ø´Ø§Ù…Ù„ Ø§Ù„Ø¹Ù…ÙˆÙ„Ø©)"}),e.jsx(k,{id:"minCommissionPrice",type:"number",value:r.minCommissionPrice,onChange:a=>m(t=>({...t,minCommissionPrice:Number(a.target.value)})),min:r.basePrice,step:"0.01",required:!0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Ø£Ù‚Ù„ Ø³Ø¹Ø± ÙŠÙ…ÙƒÙ† Ù„Ù„Ù…Ø³ÙˆÙ‚ Ø¨ÙŠØ¹ Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ù‡"})]})]}),r.basePrice>0&&r.minCommissionPrice>0&&e.jsxs("div",{className:"mt-3 p-3 bg-muted rounded-lg",children:[e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù„Ù„Ø¹Ù…ÙˆÙ„Ø©:"})," ",(r.minCommissionPrice-r.basePrice).toFixed(2)," Ø¬.Ù…"," ","(",((r.minCommissionPrice-r.basePrice)/r.basePrice*100).toFixed(1),"%)"]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Ø§Ù„Ù…Ø³ÙˆÙ‚ ÙŠÙ…ÙƒÙ†Ù‡ Ø¥Ø¶Ø§ÙØ© Ø£ÙŠ Ù‚ÙŠÙ…Ø© Ø£Ø¹Ù„Ù‰ Ù…Ù† ",r.minCommissionPrice.toFixed(2)," Ø¬.Ù…"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{children:"ØµÙˆØ± Ø§Ù„Ù…Ù†ØªØ¬"}),e.jsx(De,{value:r.images,onChange:a=>m(t=>({...t,images:a})),maxFiles:5})]}),e.jsx("div",{className:"space-y-2",children:e.jsx(Te,{value:r.verificationVideo,onChange:a=>m(t=>({...t,verificationVideo:a})),label:"ÙÙŠØ¯ÙŠÙˆ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ù†ØªØ¬",required:!s})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"tags",children:"Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ÙØªØ§Ø­ÙŠØ© (Ù…Ù†ÙØµÙ„Ø© Ø¨ÙÙˆØ§ØµÙ„)"}),e.jsx(k,{id:"tags",value:r.tags,onChange:a=>m(t=>({...t,tags:a.target.value})),placeholder:"Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª, Ø³Ù…Ø§Ø¹Ø§Øª, Ø¨Ù„ÙˆØªÙˆØ«"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"colors",children:"Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ù…ØªØ§Ø­Ø© (Ù…Ù†ÙØµÙ„Ø© Ø¨ÙÙˆØ§ØµÙ„)"}),e.jsx(k,{id:"colors",value:r.colors,onChange:a=>{m(t=>({...t,colors:a.target.value}))},onBlur:j,placeholder:"Ø£Ø­Ù…Ø±, Ø£Ø²Ø±Ù‚, Ø£Ø®Ø¶Ø±"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Ù…Ø«Ø§Ù„: Ø£Ø­Ù…Ø±, Ø£Ø²Ø±Ù‚, Ø£Ø³ÙˆØ¯ Ø£Ùˆ Red, Blue, Black"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"sizes",children:"Ø§Ù„Ù…Ù‚Ø§Ø³Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø© (Ù…Ù†ÙØµÙ„Ø© Ø¨ÙÙˆØ§ØµÙ„)"}),e.jsx(k,{id:"sizes",value:r.sizes,onChange:a=>{m(t=>({...t,sizes:a.target.value}))},onBlur:j,placeholder:"S, M, L, XL"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Ù…Ø«Ø§Ù„: S, M, L, XL Ø£Ùˆ 38, 40, 42, 44"})]})]}),d.length>0&&e.jsxs("div",{className:"space-y-3 border rounded-lg p-4 bg-muted/20",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(C,{className:"text-base font-semibold",children:"Ø§Ù„Ù…Ø®Ø²ÙˆÙ† Ù„ÙƒÙ„ Ù„ÙˆÙ† ÙˆÙ…Ù‚Ø§Ø³"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø®Ø²ÙˆÙ†: ",d.reduce((a,t)=>a+t.quantity,0)]})]}),e.jsx("div",{className:"grid grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-3 max-h-[300px] overflow-y-auto",children:d.map((a,t)=>e.jsxs("div",{className:"space-y-1 border rounded p-2 bg-background",children:[e.jsxs("div",{className:"text-xs font-medium text-center",children:[a.color," - ",a.size]}),e.jsx(k,{type:"number",min:"0",value:a.quantity,onChange:h=>S(a.color,a.size,Number(h.target.value)),className:"h-8 text-center",placeholder:"0"})]},t))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"ğŸ’¡ Ø£Ø¯Ø®Ù„ Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…ØªØ§Ø­Ø© Ù„ÙƒÙ„ ØªØ±ÙƒÙŠØ¨Ø© Ù„ÙˆÙ† ÙˆÙ…Ù‚Ø§Ø³. Ø§Ù„Ù…Ø®Ø²ÙˆÙ† Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø³ÙŠØªÙ… Ø­Ø³Ø§Ø¨Ù‡ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹."})]}),e.jsxs(Pe,{children:[e.jsx(z,{type:"button",variant:"outline",onClick:y,children:"Ø¥Ù„ØºØ§Ø¡"}),e.jsx(z,{type:"submit",children:s?"ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù†ØªØ¬":"Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬"})]})]})};function Xe(){const{user:s}=Ne(),[v,p]=f.useState([]),[y,r]=f.useState([]),[m,d]=f.useState(!0),[N,P]=f.useState(""),[j,S]=f.useState("all"),[I,x]=f.useState(!1),[c,a]=f.useState(null);f.useEffect(()=>{(async()=>{d(!0);try{const[l,n]=await Promise.all([be.getAll({}),we.getAll()]);let o=l.products;s&&s.labels&&!s.labels.includes("admin")&&(console.log("Filtering products for merchant:",s.$id),o=l.products.filter(F=>F.merchantId===s.$id),console.log("Merchant products:",o.length)),p(o),r(n.categories)}catch(l){console.error("Error fetching data:",l)}d(!1)})()},[s]);const t=v.filter(i=>{const l=i.name.toLowerCase().includes(N.toLowerCase())||i.description.toLowerCase().includes(N.toLowerCase()),n=j==="all"||i.category===j;return l&&n}),h=async i=>{try{const l=await O.create(i,s==null?void 0:s.$id);p(n=>[l,...n]),x(!1)}catch(l){console.error("Error adding product:",l),alert("ÙØ´Ù„ ÙÙŠ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬")}},u=async i=>{var l;try{const n=v.find(M=>M.id===i.id),o=s&&((l=s.labels)==null?void 0:l.includes("admin")),F=n&&n.merchantId===(s==null?void 0:s.$id);if(!o&&!F){alert("Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ© Ù„ØªØ¹Ø¯ÙŠÙ„ Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬");return}const w={...i};!o&&F&&(w.status="pending",alert("âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ù†Ø¬Ø§Ø­! Ø³ÙŠØªÙ… Ù…Ø±Ø§Ø¬Ø¹ØªÙ‡ Ù…Ù† Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ù‚Ø¨Ù„ Ù†Ø´Ø±Ù‡."));const q=await O.update(w);p(M=>M.map(U=>U.id===i.id?{...q,category:i.categoryId||U.category}:U)),a(null)}catch(n){console.error("Error updating product:",n),alert("ÙØ´Ù„ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù†ØªØ¬: "+n.message)}},g=async i=>{if(confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬ØŸ"))try{await O.delete(i),p(l=>l.filter(n=>n.id!==i)),alert("ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ù†Ø¬Ø§Ø­")}catch(l){console.error("Error deleting product:",l),alert("ÙØ´Ù„ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬: "+l.message)}},b=i=>{var l,n;if(i.colorSizeInventory)try{const o=JSON.parse(i.colorSizeInventory);if(Array.isArray(o)&&o.length>0)return o.reduce((w,q)=>w+(q.quantity||0),0)>0}catch(o){console.error("Error parsing inventory for product:",i.id,o)}return((l=i.colors)==null?void 0:l.length)>0||((n=i.sizes)==null?void 0:n.length)>0||i.stock!==void 0&&i.stock>0?!0:i.inStock!==void 0?i.inStock:!0};return m?e.jsx(Q,{children:e.jsx(Ae,{message:"Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª..."})}):e.jsx(Q,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª"}),e.jsxs(W,{open:I,onOpenChange:x,children:[e.jsx(X,{asChild:!0,children:e.jsxs(z,{children:[e.jsx(me,{className:"h-4 w-4 mr-2"}),"Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯"]})}),e.jsxs(G,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(Z,{children:[e.jsx(_,{children:"Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯"}),e.jsx(K,{children:"Ø£Ø¯Ø®Ù„ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ø¬Ø¯ÙŠØ¯"})]}),e.jsx(ee,{categories:y,onSubmit:h,onCancel:()=>x(!1)})]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs(T,{children:[e.jsxs(E,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(B,{className:"text-sm font-medium",children:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª"}),e.jsx(xe,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(L,{children:e.jsx("div",{className:"text-2xl font-bold",children:v.length})})]}),e.jsxs(T,{children:[e.jsxs(E,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(B,{className:"text-sm font-medium",children:"Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©"}),e.jsx(H,{className:"h-4 w-4 text-green-600"})]}),e.jsx(L,{children:e.jsx("div",{className:"text-2xl font-bold",children:v.filter(i=>b(i)).length})})]}),e.jsxs(T,{children:[e.jsxs(E,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(B,{className:"text-sm font-medium",children:"Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ØºÙŠØ± Ø§Ù„Ù…ØªØ§Ø­Ø©"}),e.jsx(he,{className:"h-4 w-4 text-red-600"})]}),e.jsx(L,{children:e.jsx("div",{className:"text-2xl font-bold",children:v.filter(i=>!b(i)).length})})]}),e.jsxs(T,{children:[e.jsxs(E,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(B,{className:"text-sm font-medium",children:"Ù…ØªÙˆØ³Ø· Ø§Ù„ØªÙ‚ÙŠÙŠÙ…"}),e.jsx(H,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(L,{children:e.jsx("div",{className:"text-2xl font-bold",children:v.length>0?(v.reduce((i,l)=>i+l.rating,0)/v.length).toFixed(1):"0.0"})})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),e.jsx(k,{placeholder:"Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª...",value:N,onChange:i=>P(i.target.value),className:"pl-10"})]})}),e.jsxs(te,{value:j,onValueChange:S,children:[e.jsx(re,{className:"w-48",children:e.jsx(le,{})}),e.jsxs(ne,{children:[e.jsx(J,{value:"all",children:"Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØ¦Ø§Øª"}),y.map(i=>e.jsx(J,{value:i.id,children:i.name},i.id))]})]})]}),e.jsxs(T,{children:[e.jsx(E,{children:e.jsxs(B,{children:["Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª (",t.length,")"]})}),e.jsx(L,{children:e.jsxs(Se,{children:[e.jsx(ke,{children:e.jsxs(Y,{children:[e.jsx(A,{children:"Ø§Ù„Ù…Ù†ØªØ¬"}),e.jsx(A,{children:"Ø§Ù„ÙØ¦Ø©"}),e.jsx(A,{children:"Ø§Ù„Ø³Ø¹Ø±"}),e.jsx(A,{children:"Ø§Ù„ØªÙ‚ÙŠÙŠÙ…"}),e.jsx(A,{children:"Ø§Ù„Ù…Ø®Ø²ÙˆÙ†"}),e.jsx(A,{children:"Ø§Ù„Ø¹Ù…ÙˆÙ„Ø©"}),e.jsx(A,{className:"text-center",children:"Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª"})]})}),e.jsx(Ie,{children:t.map(i=>{var n;const l=y.find(o=>o.id===i.category);return e.jsxs(Y,{children:[e.jsx(D,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:ye((n=i.images)==null?void 0:n[0]),alt:i.name,className:"w-10 h-10 rounded object-cover"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:i.name}),e.jsx("div",{className:"text-sm text-muted-foreground truncate max-w-[200px]",children:i.description})]})]})}),e.jsx(D,{children:e.jsx(R,{variant:"outline",children:(l==null?void 0:l.name)||i.category})}),e.jsx(D,{children:e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium",children:[i.price," Ø¬.Ù…"]}),i.originalPrice&&e.jsxs("div",{className:"text-sm text-muted-foreground line-through",children:[i.originalPrice," Ø¬.Ù…"]})]})}),e.jsx(D,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:i.rating.toFixed(1)}),e.jsxs("span",{className:"text-muted-foreground",children:["(",i.reviewCount,")"]})]})}),e.jsx(D,{children:e.jsx(R,{variant:i.inStock?"default":"secondary",children:i.inStock?"Ù…ØªØ§Ø­":"ØºÙŠØ± Ù…ØªØ§Ø­"})}),e.jsxs(D,{children:[i.affiliateCommission,"%"]}),e.jsx(D,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(W,{open:(c==null?void 0:c.id)===i.id,onOpenChange:o=>!o&&a(null),children:[e.jsx(X,{asChild:!0,children:e.jsx(z,{variant:"outline",size:"sm",onClick:()=>a(i),children:e.jsx(je,{className:"h-4 w-4"})})}),e.jsxs(G,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(Z,{children:[e.jsx(_,{children:"ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬"}),e.jsx(K,{children:"ØªØ¹Ø¯ÙŠÙ„ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬"})]}),c&&e.jsx(ee,{product:c,categories:y,onSubmit:u,onCancel:()=>a(null)})]})]}),e.jsx(z,{variant:"outline",size:"sm",onClick:()=>{confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬ØŸ")&&g(i.id)},children:e.jsx(ue,{className:"h-4 w-4 text-red-600"})})]})})]},i.id)})})]})})]})]})})}export{Xe as default};
