import{l as K,r as B,m as M,j as e,bu as C,au as S,o as E,_ as q,bg as F,ay as Q}from"./vendor-react-wP-gPk8e.js";import{o as W,C as l,f as n,e as k,r as d,s as c,H as h,B as w,d as _}from"./index-BjwBfcA6.js";import{Q as A}from"./vendor-appwrite-BGb_FC-V.js";import{T as G,a as H,b as j,c as f}from"./tabs-W766L0g2.js";import{ao as u,ay as P,aq as D,ar as I,as as x,at as p,au as R,az as v,aw as z,ax as g,aA as V,aB as X,aC as Y}from"./vendor-other-DcnDEVts.js";import"./vendor-ui-BA32w1ww.js";import"./vendor-query-GexG3wnZ.js";import"./vendor-animations-W1Z2cmit.js";const J="";function re(){const{user:i}=W(),y=K(),[O,U]=B.useState("7days"),{data:r=[],isLoading:L}=M({queryKey:["affiliate-links",i==null?void 0:i.$id],queryFn:async()=>i!=null&&i.$id?(await _.listDocuments(J,"affiliate_links",[A.equal("affiliateId",i.$id),A.orderDesc("$createdAt")])).documents:[],enabled:!!(i!=null&&i.$id)}),a={totalClicks:r.reduce((s,t)=>s+(t.clicks||0),0),totalConversions:r.reduce((s,t)=>s+(t.conversions||0),0),totalRevenue:r.reduce((s,t)=>s+(t.revenue||0),0),totalLinks:r.length,avgConversionRate:r.length>0?(r.reduce((s,t)=>{const o=t.clicks>0?t.conversions/t.clicks*100:0;return s+o},0)/r.length).toFixed(2):"0.00"},T=()=>{const s=[],t=new Date;for(let o=6;o>=0;o--){const m=new Date(t);m.setDate(m.getDate()-o);const $=m.toLocaleDateString("ar-EG",{month:"short",day:"numeric"});s.push({date:$,clicks:Math.floor(Math.random()*50)+10,conversions:Math.floor(Math.random()*10),revenue:Math.floor(Math.random()*500)+100})}return s},N=[...r].sort((s,t)=>(t.revenue||0)-(s.revenue||0)).slice(0,5).map(s=>({linkCode:s.linkCode,clicks:s.clicks||0,conversions:s.conversions||0,revenue:s.revenue||0})),b=[{name:"النقرات",value:a.totalClicks,fill:"#f97316"},{name:"التحويلات",value:a.totalConversions,fill:"#10b981"}];return i!=null&&i.isAffiliate?L?e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"text-center py-12",children:"جاري التحميل..."})}):e.jsxs("div",{className:"container mx-auto px-4 py-8 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"لوحة التحليلات"}),e.jsx("p",{className:"text-muted-foreground",children:"تابع أداء حملاتك التسويقية بالتفصيل"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(l,{children:[e.jsx(d,{className:"pb-2",children:e.jsxs(c,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(S,{className:"h-4 w-4"}),"إجمالي النقرات"]})}),e.jsxs(n,{children:[e.jsx("div",{className:"text-3xl font-bold",children:a.totalClicks}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["من ",a.totalLinks," رابط نشط"]})]})]}),e.jsxs(l,{children:[e.jsx(d,{className:"pb-2",children:e.jsxs(c,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(E,{className:"h-4 w-4"}),"إجمالي التحويلات"]})}),e.jsxs(n,{children:[e.jsx("div",{className:"text-3xl font-bold text-green-600",children:a.totalConversions}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["معدل التحويل ",a.avgConversionRate,"%"]})]})]}),e.jsxs(l,{children:[e.jsx(d,{className:"pb-2",children:e.jsxs(c,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(q,{className:"h-4 w-4"}),"إجمالي العمولات"]})}),e.jsxs(n,{children:[e.jsxs("div",{className:"text-3xl font-bold text-primary",children:[a.totalRevenue.toFixed(2)," جنيه"]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["متوسط ",(a.totalRevenue/(a.totalConversions||1)).toFixed(2)," لكل تحويل"]})]})]}),e.jsxs(l,{children:[e.jsx(d,{className:"pb-2",children:e.jsxs(c,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(F,{className:"h-4 w-4"}),"معدل التحويل"]})}),e.jsxs(n,{children:[e.jsxs("div",{className:"text-3xl font-bold",children:[a.avgConversionRate,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"متوسط جميع الروابط"})]})]})]}),e.jsxs(G,{defaultValue:"performance",className:"space-y-4",children:[e.jsxs(H,{children:[e.jsx(j,{value:"performance",children:"الأداء اليومي"}),e.jsx(j,{value:"top-links",children:"أفضل الروابط"}),e.jsx(j,{value:"funnel",children:"مسار التحويل"})]}),e.jsx(f,{value:"performance",children:e.jsxs(l,{children:[e.jsxs(d,{children:[e.jsx(c,{children:"الأداء اليومي - آخر 7 أيام"}),e.jsx(h,{children:"تتبع النقرات والتحويلات والعمولات يومياً"})]}),e.jsx(n,{children:e.jsx(u,{width:"100%",height:400,children:e.jsxs(P,{data:T(),children:[e.jsx(D,{strokeDasharray:"3 3"}),e.jsx(I,{dataKey:"date"}),e.jsx(x,{yAxisId:"left"}),e.jsx(x,{yAxisId:"right",orientation:"right"}),e.jsx(p,{}),e.jsx(R,{}),e.jsx(v,{yAxisId:"left",type:"monotone",dataKey:"clicks",stroke:"#f97316",strokeWidth:2,name:"النقرات"}),e.jsx(v,{yAxisId:"left",type:"monotone",dataKey:"conversions",stroke:"#10b981",strokeWidth:2,name:"التحويلات"}),e.jsx(v,{yAxisId:"right",type:"monotone",dataKey:"revenue",stroke:"#3b82f6",strokeWidth:2,name:"العمولة (جنيه)"})]})})})]})}),e.jsx(f,{value:"top-links",children:e.jsxs(l,{children:[e.jsxs(d,{children:[e.jsx(c,{children:"أفضل 5 روابط أداءً"}),e.jsx(h,{children:"الروابط التي حققت أعلى عمولات"})]}),e.jsx(n,{children:N.length===0?e.jsx("div",{className:"text-center py-12 text-muted-foreground",children:"لا توجد بيانات كافية لعرض الرسم البياني"}):e.jsx(u,{width:"100%",height:400,children:e.jsxs(z,{data:N,children:[e.jsx(D,{strokeDasharray:"3 3"}),e.jsx(I,{dataKey:"linkCode"}),e.jsx(x,{yAxisId:"left"}),e.jsx(x,{yAxisId:"right",orientation:"right"}),e.jsx(p,{}),e.jsx(R,{}),e.jsx(g,{yAxisId:"left",dataKey:"clicks",fill:"#f97316",name:"النقرات"}),e.jsx(g,{yAxisId:"left",dataKey:"conversions",fill:"#10b981",name:"التحويلات"}),e.jsx(g,{yAxisId:"right",dataKey:"revenue",fill:"#3b82f6",name:"العمولة"})]})})})]})}),e.jsx(f,{value:"funnel",children:e.jsxs(l,{children:[e.jsxs(d,{children:[e.jsx(c,{children:"مسار التحويل"}),e.jsx(h,{children:"تحليل رحلة العميل من النقرة إلى الشراء"})]}),e.jsx(n,{children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[e.jsx("div",{children:e.jsx(u,{width:"100%",height:300,children:e.jsxs(V,{children:[e.jsx(X,{data:b,cx:"50%",cy:"50%",labelLine:!1,label:({name:s,value:t})=>`${s}: ${t}`,outerRadius:100,dataKey:"value",children:b.map((s,t)=>e.jsx(Y,{fill:s.fill},`cell-${t}`))}),e.jsx(p,{})]})})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"النقرات"}),e.jsx(w,{variant:"outline",children:a.totalClicks})]}),e.jsx("div",{className:"h-2 bg-muted rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-orange-500",style:{width:"100%"}})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"التحويلات"}),e.jsx(w,{variant:"outline",children:a.totalConversions})]}),e.jsx("div",{className:"h-2 bg-muted rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-green-500",style:{width:`${a.totalClicks>0?a.totalConversions/a.totalClicks*100:0}%`}})})]}),e.jsxs("div",{className:"pt-4 border-t",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(C,{className:"h-5 w-5 text-primary"}),e.jsx("span",{className:"font-semibold",children:"معدل التحويل"})]}),e.jsxs("div",{className:"text-3xl font-bold text-primary",children:[a.avgConversionRate,"%"]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:a.totalClicks>0?`${a.totalConversions} من ${a.totalClicks} نقرة أصبحت عملية شراء`:"لا توجد بيانات بعد"})]})]})]})})]})})]}),e.jsxs(l,{className:"bg-gradient-to-r from-primary/10 to-orange-500/10 border-primary",children:[e.jsx(d,{children:e.jsxs(c,{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"h-5 w-5"}),"نصائح لتحسين الأداء"]})}),e.jsxs(n,{className:"space-y-2",children:[e.jsx("p",{className:"text-sm",children:"• معدل تحويل أعلى من 5% يُعتبر ممتاز - استمر بهذا الأداء!"}),e.jsx("p",{className:"text-sm",children:"• ركز على الروابط ذات الأداء الأفضل وأنشئ المزيد من المحتوى حولها"}),e.jsx("p",{className:"text-sm",children:"• جرب أوقات نشر مختلفة لمعرفة متى يكون جمهورك أكثر نشاطاً"}),e.jsx("p",{className:"text-sm",children:"• استخدم البانرات والأدوات التسويقية لزيادة النقرات"})]})]})]}):e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx(l,{children:e.jsxs(n,{className:"p-12 text-center space-y-4",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(C,{className:"h-8 w-8 text-orange-600"})}),e.jsx("h2",{className:"text-2xl font-bold",children:"هذه الصفحة للمسوقين فقط"}),e.jsx("p",{className:"text-muted-foreground max-w-md mx-auto",children:"يجب أن يكون حسابك مفعّلاً كحساب مسوق للوصول إلى لوحة التحليلات والإحصائيات"}),e.jsxs("div",{className:"flex gap-3 justify-center pt-4",children:[e.jsx(k,{onClick:()=>y("/update-affiliate-prefs"),children:"تفعيل حساب المسوق"}),e.jsx(k,{variant:"outline",onClick:()=>y("/affiliate"),children:"معرفة المزيد"})]})]})})})}export{re as default};
