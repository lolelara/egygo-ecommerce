import{a8 as c,a0 as a}from"./index-Ce-RwxJS.js";const d="68de037e003bd03c4d45",l={USERS:"users",ORDERS:"orders",COMMISSIONS:"commissions",PRODUCTS:"products"},D={getStats:async s=>{try{const e=await c.getDocument(d,l.USERS,s),o=(await c.listDocuments(d,l.COMMISSIONS,[a.equal("affiliateId",s),a.orderDesc("$createdAt")])).documents,n=o.filter(t=>t.status==="paid").reduce((t,r)=>t+r.amount,0),f=o.filter(t=>t.status==="pending").reduce((t,r)=>t+r.amount,0),i=(await c.listDocuments(d,l.ORDERS,[a.equal("affiliateCode",e.affiliateCode||""),a.limit(1e3)])).documents,h=i.length,m=new Date,g=new Date(m.getFullYear(),m.getMonth(),1),S=o.filter(t=>new Date(t.$createdAt)>=g).reduce((t,r)=>t+r.amount,0),w=o.slice(0,10).map(t=>({id:t.$id,orderId:t.orderId,amount:t.amount,status:t.status,createdAt:t.$createdAt}));return{affiliateCode:e.affiliateCode||`AFF${s.substring(0,6).toUpperCase()}`,commissionRate:e.commissionRate||10,totalEarnings:n,pendingEarnings:f,thisMonthEarnings:S,referralCount:h,recentCommissions:w,clicks:e.clicks||0,conversions:i.length,conversionRate:e.clicks?(i.length/e.clicks*100).toFixed(2):0}}catch(e){throw console.error("Error fetching affiliate stats:",e),e}},getWithdrawals:async s=>{try{return[]}catch(e){return console.error("Error fetching withdrawals:",e),[]}},requestWithdrawal:async(s,e,u,o)=>{try{throw new Error("سيتم تفعيل طلبات السحب قريباً")}catch(n){throw new Error(n.message||"فشل في إنشاء طلب السحب")}}};export{D as a};
