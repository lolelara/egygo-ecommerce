import{r as l,j as e,n as w,a_ as y,bz as j,bA as u,a0 as $,a7 as L,ax as q}from"./vendor-react-CCFRLLzk.js";import{d as z,D as I}from"./appwrite-client-DFce-dPK.js";import{Q as m}from"./vendor-appwrite-CuqfvTq9.js";import{c as P,C as r,x as c,y as d,h as n,P as H,g as Q,f as C,D as _,z as F,A as G,E as M,F as O,B as g}from"./index-D-h96Znd.js";import{T as U,a as V,b as h,c as X}from"./tabs-LmPLZOOP.js";import{A as J}from"./AdminLayout-l1ioQrwl.js";import"./vendor-ui-BA32w1ww.js";import"./vendor-query-j_rPqiug.js";import"./vendor-other-CzBBjgu5.js";import"./vendor-animations-CPHPqPXb.js";import"./avatar-diaDjQwV.js";function ie(){const{user:o}=P(),[a,D]=l.useState([]),[A,f]=l.useState(!0),[i,S]=l.useState("all"),[t,T]=l.useState(null),[E,p]=l.useState(!1);l.useEffect(()=>{o&&k()},[o,i]);const k=async()=>{if(o)try{f(!0);const s=[m.equal("merchantId",o.$id),m.orderDesc("$createdAt"),m.limit(100)];i!=="all"&&s.push(m.equal("status",i));const x=await z.listDocuments(I,"products",s);D(x.documents)}catch(s){console.error("Error loading products:",s)}finally{f(!1)}},R=s=>{switch(s){case"approved":return e.jsxs(g,{className:"bg-green-500",children:[e.jsx(y,{className:"h-3 w-3 ml-1"}),"موافق عليه"]});case"rejected":return e.jsxs(g,{variant:"destructive",children:[e.jsx(u,{className:"h-3 w-3 ml-1"}),"مرفوض"]});case"pending":return e.jsxs(g,{variant:"secondary",children:[e.jsx(j,{className:"h-3 w-3 ml-1"}),"قيد المراجعة"]});default:return null}},B=s=>{T(s),p(!0)},N=a.filter(s=>s.status==="pending").length,b=a.filter(s=>s.status==="approved").length,v=a.filter(s=>s.status==="rejected").length;return e.jsxs(J,{children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold",children:"حالة المنتجات"}),e.jsx("p",{className:"text-muted-foreground",children:"تتبع حالة منتجاتك والموافقات"})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs(r,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm font-medium",children:"إجمالي المنتجات"}),e.jsx(w,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(n,{children:e.jsx("div",{className:"text-2xl font-bold",children:a.length})})]}),e.jsxs(r,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm font-medium",children:"موافق عليها"}),e.jsx(y,{className:"h-4 w-4 text-green-500"})]}),e.jsx(n,{children:e.jsx("div",{className:"text-2xl font-bold text-green-600",children:b})})]}),e.jsxs(r,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm font-medium",children:"قيد المراجعة"}),e.jsx(j,{className:"h-4 w-4 text-yellow-500"})]}),e.jsx(n,{children:e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:N})})]}),e.jsxs(r,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm font-medium",children:"مرفوضة"}),e.jsx(u,{className:"h-4 w-4 text-red-500"})]}),e.jsx(n,{children:e.jsx("div",{className:"text-2xl font-bold text-red-600",children:v})})]})]}),e.jsxs(r,{children:[e.jsxs(c,{children:[e.jsx(d,{children:"منتجاتي"}),e.jsx(H,{children:"جميع منتجاتك مع حالة الموافقة"})]}),e.jsx(n,{children:e.jsxs(U,{value:i,onValueChange:S,children:[e.jsxs(V,{className:"grid w-full grid-cols-4",children:[e.jsxs(h,{value:"all",children:["الكل (",a.length,")"]}),e.jsxs(h,{value:"approved",children:["موافق عليها (",b,")"]}),e.jsxs(h,{value:"pending",children:["قيد المراجعة (",N,")"]}),e.jsxs(h,{value:"rejected",children:["مرفوضة (",v,")"]})]}),e.jsx(X,{value:i,className:"mt-6",children:A?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"}),e.jsx("p",{className:"mt-2 text-muted-foreground",children:"جاري التحميل..."})]}):a.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(w,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground opacity-50"}),e.jsx("p",{className:"text-muted-foreground",children:"لا توجد منتجات"})]}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:a.map(s=>{var x;return e.jsxs(r,{className:"overflow-hidden",children:[e.jsxs("div",{className:"aspect-square relative bg-gray-100",children:[((x=s.images)==null?void 0:x[0])&&e.jsx("img",{src:Q(s.images[0]),alt:s.name,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute top-2 right-2",children:R(s.status)})]}),e.jsxs(n,{className:"p-4",children:[e.jsx("h3",{className:"font-semibold text-lg mb-2 line-clamp-1",children:s.name}),e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2 mb-3",children:s.description}),e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("span",{className:"text-lg font-bold text-primary",children:[s.price," ج.م"]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["المخزون: ",s.stock]})]}),s.status==="rejected"&&s.rejectionReason&&e.jsxs(C,{variant:"outline",size:"sm",className:"w-full mb-2",onClick:()=>B(s),children:[e.jsx($,{className:"h-4 w-4 ml-2"}),"عرض سبب الرفض"]}),s.status==="pending"&&e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 text-sm",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(j,{className:"h-4 w-4 text-yellow-600 mt-0.5"}),e.jsx("p",{className:"text-yellow-800",children:"منتجك قيد المراجعة من قبل الإدارة. سيتم إخطارك عند الموافقة عليه."})]})}),s.status==="approved"&&e.jsx(L,{to:`/products/${s.$id}`,children:e.jsxs(C,{variant:"outline",size:"sm",className:"w-full",children:[e.jsx(q,{className:"h-4 w-4 ml-2"}),"معاينة في الموقع"]})}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-2",children:["تاريخ الإضافة: ",new Date(s.$createdAt).toLocaleDateString("ar-EG")]})]})]},s.$id)})})})]})})]})]}),e.jsx(_,{open:E,onOpenChange:p,children:e.jsxs(F,{children:[e.jsxs(G,{children:[e.jsx(M,{children:"سبب رفض المنتج"}),e.jsxs(O,{children:["المنتج: ",t==null?void 0:t.name]})]}),e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(u,{className:"h-5 w-5 text-red-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-red-900 mb-2",children:"سبب الرفض:"}),e.jsx("p",{className:"text-red-800",children:(t==null?void 0:t.rejectionReason)||"لم يتم تحديد سبب"})]})]})}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mt-4",children:e.jsxs("p",{className:"text-sm text-blue-800",children:["💡 ",e.jsx("strong",{children:"نصيحة:"})," يمكنك تعديل المنتج وإعادة رفعه مرة أخرى بعد معالجة المشكلة المذكورة."]})})]})})]})}export{ie as default};
