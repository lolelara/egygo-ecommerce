import{b as V,w as _,j as s,ax as K,r as o,a8 as D,a0 as v,L as W,C as a,e as l,f as i,a6 as x,g as t,B as c,d as h,ac as T,ay as E,ab as w,a as j,an as X,q as f,aa as k,I as Y,am as b,N as Z,J as F,a2 as ss,a3 as es,a4 as N,a5 as p}from"./index-Ce-RwxJS.js";import{P as as}from"./PendingApprovalScreen-B5jbSVio.js";import{a as ts}from"./affiliate-api-Do0vmgJQ.js";import{L}from"./link-eq3syxrq.js";import{T as rs}from"./target-CDawgCx5.js";import{C as I}from"./circle-check-big-DrIPWHSB.js";import{C as ls}from"./copy-CCGvNwUs.js";import{G as P}from"./gift-51jgOl60.js";import{C as is}from"./clock-D_TAAEO_.js";import{D as B}from"./download-UgG-gTV9.js";import"./phone-D4T1FDJZ.js";const R="68de037e003bd03c4d45";function gs(){const{toast:y}=V(),{user:d}=_();if(d?.isAffiliate&&d?.accountStatus==="pending")return s.jsx(as,{});if(!d?.isAffiliate)return s.jsx(K,{to:"/affiliate",replace:!0});const[G,C]=o.useState(!1),[M,S]=o.useState(!0),[r,q]=o.useState(null),[z,Q]=o.useState([]),[H,ns]=o.useState([]);o.useEffect(()=>{d?.$id&&$()},[d]);const $=async()=>{try{S(!0);const e=await ts.getStats(d.$id);q(e);const g=await D.listDocuments(R,"commissions",[v.equal("affiliateId",d.$id),v.orderDesc("$createdAt"),v.limit(10)]),U=await Promise.all(g.documents.slice(0,3).map(async n=>{try{const u=await D.getDocument(R,"orders",n.orderId);return{id:u.orderNumber||n.$id,product:u.items?.[0]?.name||"منتج",customer:`عميل ${u.userId?.substring(0,4)}`,amount:n.orderAmount||0,commission:n.amount||0,date:new Date(n.$createdAt).toLocaleDateString("ar-EG"),status:n.status==="PAID"?"completed":"pending"}}catch{return{id:n.$id,product:"منتج",customer:"عميل",amount:n.orderAmount||0,commission:n.amount||0,date:new Date(n.$createdAt).toLocaleDateString("ar-EG"),status:n.status==="PAID"?"completed":"pending"}}}));Q(U)}catch(e){console.error("Error fetching affiliate data:",e),y({variant:"destructive",title:"خطأ",description:"فشل في تحميل بيانات المسوق"})}finally{S(!1)}},J=d?.prefs?.affiliateCode||d?.$id?.substring(0,8)||"AFFILIATE",A=`${window.location.origin}/#/ref/${J}`,O=e=>{navigator.clipboard.writeText(e),C(!0),y({title:"تم النسخ!",description:"تم نسخ الرابط إلى الحافظة"}),setTimeout(()=>C(!1),2e3)};if(M)return s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsxs("div",{className:"flex flex-col items-center gap-4",children:[s.jsx(W,{className:"h-8 w-8 animate-spin text-primary"}),s.jsx("p",{className:"text-muted-foreground",children:"جاري تحميل بيانات المسوق..."})]})});if(!r)return s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsxs(a,{className:"w-full max-w-md",children:[s.jsxs(l,{children:[s.jsx(i,{children:"خطأ"}),s.jsx(x,{children:"فشل في تحميل بيانات المسوق"})]}),s.jsx(t,{children:s.jsx(c,{onClick:$,children:"إعادة المحاولة"})})]})});const m={current:"Bronze",next:"Silver",salesNeeded:50,currentSales:r.conversions||0,percentage:(r.conversions||0)/50*100};return s.jsx("div",{className:"min-h-screen bg-gray-50",children:s.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-7xl",children:[s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8",children:[s.jsx(h,{to:"/affiliate/links",children:s.jsx(a,{className:"hover:shadow-lg transition-shadow cursor-pointer border-primary/20",children:s.jsxs(t,{className:"p-4 text-center",children:[s.jsx(L,{className:"h-8 w-8 mx-auto mb-2 text-primary"}),s.jsx("h3",{className:"font-semibold text-sm",children:"إدارة الروابط"}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"أنشئ وتتبع روابطك"})]})})}),s.jsx(h,{to:"/affiliate/analytics",children:s.jsx(a,{className:"hover:shadow-lg transition-shadow cursor-pointer border-orange-500/20",children:s.jsxs(t,{className:"p-4 text-center",children:[s.jsx(T,{className:"h-8 w-8 mx-auto mb-2 text-orange-500"}),s.jsx("h3",{className:"font-semibold text-sm",children:"التحليلات"}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"رسوم بيانية وإحصائيات"})]})})}),s.jsx(h,{to:"/affiliate/creatives",children:s.jsx(a,{className:"hover:shadow-lg transition-shadow cursor-pointer border-green-500/20",children:s.jsxs(t,{className:"p-4 text-center",children:[s.jsx(E,{className:"h-8 w-8 mx-auto mb-2 text-green-500"}),s.jsx("h3",{className:"font-semibold text-sm",children:"أدوات تسويقية"}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"بانرات ورموز QR"})]})})}),s.jsx(h,{to:"/affiliate/withdraw",children:s.jsx(a,{className:"hover:shadow-lg transition-shadow cursor-pointer border-purple-500/20",children:s.jsxs(t,{className:"p-4 text-center",children:[s.jsx(w,{className:"h-8 w-8 mx-auto mb-2 text-purple-500"}),s.jsx("h3",{className:"font-semibold text-sm",children:"سحب الأرباح"}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"اسحب عمولاتك"})]})})})]}),s.jsxs("div",{className:"mb-8",children:[s.jsxs("div",{className:"flex justify-between items-start mb-4",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold",children:"لوحة تحكم المسوق"}),s.jsx("p",{className:"text-muted-foreground",children:"تتبع أرباحك وإحصائياتك التسويقية"})]}),s.jsxs(j,{variant:"default",className:"text-lg px-4 py-2",children:[s.jsx(X,{className:"h-5 w-5 ml-2"}),m.current," Tier"]})]}),s.jsx(a,{children:s.jsxs(t,{className:"pt-6",children:[s.jsxs("div",{className:"flex justify-between items-center mb-2",children:[s.jsxs("p",{className:"text-sm font-medium",children:["تقدمك نحو ",m.next," Tier"]}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:[m.currentSales," / ",m.salesNeeded," مبيعة"]})]}),s.jsx(f,{value:m.percentage,className:"h-3"}),s.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:[m.salesNeeded-m.currentSales," مبيعة متبقية للوصول إلى المستوى الذهبي وزيادة نسبة العمولة!"]})]})})]}),s.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4 mb-8",children:[s.jsxs(a,{children:[s.jsxs(l,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(i,{className:"text-sm font-medium",children:"إجمالي الأرباح"}),s.jsx(w,{className:"h-4 w-4 text-muted-foreground"})]}),s.jsxs(t,{children:[s.jsxs("div",{className:"text-2xl font-bold",children:["$",(r.totalEarnings||0).toFixed(2)]}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"منذ الانضمام"})]})]}),s.jsxs(a,{children:[s.jsxs(l,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(i,{className:"text-sm font-medium",children:"هذا الشهر"}),s.jsx(k,{className:"h-4 w-4 text-muted-foreground"})]}),s.jsxs(t,{children:[s.jsxs("div",{className:"text-2xl font-bold",children:["$",(r.thisMonthEarnings||0).toFixed(2)]}),s.jsxs("div",{className:"flex items-center text-xs mt-1",children:[s.jsx(k,{className:"h-3 w-3 text-green-500 ml-1"}),s.jsxs("span",{className:"text-green-500",children:[r.thisMonthEarnings>0?"+":"",(r.thisMonthEarnings/Math.max(r.totalEarnings,1)*100).toFixed(1),"%"]})]})]})]}),s.jsxs(a,{children:[s.jsxs(l,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(i,{className:"text-sm font-medium",children:"معدل التحويل"}),s.jsx(rs,{className:"h-4 w-4 text-muted-foreground"})]}),s.jsxs(t,{children:[s.jsxs("div",{className:"text-2xl font-bold",children:[(r.conversionRate||0).toFixed(1),"%"]}),s.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[r.conversions||0," مبيعة من ",r.referralCount||0," إحالة"]})]})]}),s.jsxs(a,{children:[s.jsxs(l,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(i,{className:"text-sm font-medium",children:"جاهز للسحب"}),s.jsx(I,{className:"h-4 w-4 text-muted-foreground"})]}),s.jsxs(t,{children:[s.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["$",((r.totalEarnings||0)-(r.pendingEarnings||0)).toFixed(2)]}),s.jsx(h,{to:"/affiliate/withdraw",children:s.jsx(c,{size:"sm",className:"mt-2 w-full",children:"سحب الآن"})})]})]})]}),s.jsxs(a,{className:"mb-8",children:[s.jsxs(l,{children:[s.jsx(i,{children:"رابط الإحالة الخاص بك"}),s.jsx(x,{children:"شارك هذا الرابط لكسب عمولة على كل عملية بيع"})]}),s.jsxs(t,{className:"space-y-4",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsx(Y,{value:A,readOnly:!0,className:"font-mono"}),s.jsxs(c,{onClick:()=>O(A),variant:"outline",children:[s.jsx(ls,{className:"h-4 w-4 ml-2"}),G?"تم النسخ!":"نسخ"]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[s.jsxs(c,{variant:"outline",className:"w-full",children:[s.jsx(b,{className:"h-4 w-4 ml-2"}),"فيسبوك"]}),s.jsxs(c,{variant:"outline",className:"w-full",children:[s.jsx(b,{className:"h-4 w-4 ml-2"}),"تويتر"]}),s.jsxs(c,{variant:"outline",className:"w-full",children:[s.jsx(b,{className:"h-4 w-4 ml-2"}),"واتساب"]})]}),s.jsxs("div",{className:"flex gap-4 text-sm",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Z,{className:"h-4 w-4 text-muted-foreground"}),s.jsxs("span",{children:[r.totalClicks," زيارة"]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(F,{className:"h-4 w-4 text-muted-foreground"}),s.jsxs("span",{children:[r.totalSales," مبيعة"]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(w,{className:"h-4 w-4 text-muted-foreground"}),s.jsx("span",{children:"نسبة العمولة: 15%"})]})]})]})]}),s.jsxs(ss,{defaultValue:"sales",className:"space-y-4",children:[s.jsxs(es,{className:"grid w-full grid-cols-4",children:[s.jsxs(N,{value:"sales",children:[s.jsx(F,{className:"h-4 w-4 ml-2"}),"المبيعات"]}),s.jsxs(N,{value:"products",children:[s.jsx(T,{className:"h-4 w-4 ml-2"}),"أفضل المنتجات"]}),s.jsxs(N,{value:"tools",children:[s.jsx(E,{className:"h-4 w-4 ml-2"}),"أدوات التسويق"]}),s.jsxs(N,{value:"rewards",children:[s.jsx(P,{className:"h-4 w-4 ml-2"}),"المكافآت"]})]}),s.jsx(p,{value:"sales",children:s.jsxs(a,{children:[s.jsxs(l,{children:[s.jsx(i,{children:"المبيعات الأخيرة"}),s.jsx(x,{children:"تفاصيل العمولات من مبيعاتك"})]}),s.jsx(t,{children:s.jsx("div",{className:"space-y-3",children:z.map(e=>s.jsxs("div",{className:"flex items-center justify-between p-4 rounded-lg border",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-medium",children:e.id}),s.jsx(j,{variant:e.status==="completed"?"default":"secondary",children:e.status==="completed"?s.jsxs(s.Fragment,{children:[s.jsx(I,{className:"h-3 w-3 ml-1"}),"مكتمل"]}):s.jsxs(s.Fragment,{children:[s.jsx(is,{className:"h-3 w-3 ml-1"}),"قيد المعالجة"]})})]}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.product," - $",e.amount]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:e.date})]}),s.jsxs("div",{className:"text-left",children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"عمولتك"}),s.jsxs("p",{className:"text-lg font-bold text-green-600",children:["$",e.commission.toFixed(2)]})]})]},e.id))})})]})}),s.jsx(p,{value:"products",children:s.jsxs(a,{children:[s.jsxs(l,{children:[s.jsx(i,{children:"أفضل منتجاتك أداءً"}),s.jsx(x,{children:"المنتجات التي تحقق أعلى عمولات"})]}),s.jsx(t,{children:s.jsx("div",{className:"space-y-4",children:H.map((e,g)=>s.jsxs("div",{className:"flex items-center justify-between p-4 rounded-lg border",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"font-semibold",children:e.name}),s.jsxs("div",{className:"flex gap-4 mt-2 text-sm text-muted-foreground",children:[s.jsxs("span",{children:[e.sales," مبيعة"]}),s.jsxs("span",{children:[e.clicks," نقرة"]}),s.jsxs("span",{children:["معدل التحويل:"," ",(e.sales/e.clicks*100).toFixed(1),"%"]})]})]}),s.jsxs("div",{className:"text-left",children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"إجمالي العمولات"}),s.jsxs("p",{className:"text-xl font-bold text-green-600",children:["$",e.commission.toFixed(2)]})]})]},g))})})]})}),s.jsx(p,{value:"tools",children:s.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[s.jsxs(a,{children:[s.jsxs(l,{children:[s.jsx(i,{children:"روابط مخصصة للمنتجات"}),s.jsx(x,{children:"أنشئ روابط خاصة لمنتجات محددة"})]}),s.jsx(t,{children:s.jsxs(c,{className:"w-full",children:[s.jsx(L,{className:"h-4 w-4 ml-2"}),"إنشاء رابط جديد"]})})]}),s.jsxs(a,{children:[s.jsxs(l,{children:[s.jsx(i,{children:"بانرات إعلانية"}),s.jsx(x,{children:"تحميل صور جاهزة للترويج"})]}),s.jsx(t,{children:s.jsxs(c,{variant:"outline",className:"w-full",children:[s.jsx(B,{className:"h-4 w-4 ml-2"}),"تحميل البانرات"]})})]}),s.jsxs(a,{children:[s.jsxs(l,{children:[s.jsx(i,{children:"كوبونات خصم"}),s.jsx(x,{children:"أنشئ كوبونات خاصة لعملائك"})]}),s.jsx(t,{children:s.jsxs(c,{className:"w-full",children:[s.jsx(P,{className:"h-4 w-4 ml-2"}),"إنشاء كوبون"]})})]}),s.jsxs(a,{children:[s.jsxs(l,{children:[s.jsx(i,{children:"تقارير مفصلة"}),s.jsx(x,{children:"تصدير تقارير الأداء"})]}),s.jsx(t,{children:s.jsxs(c,{variant:"outline",className:"w-full",children:[s.jsx(B,{className:"h-4 w-4 ml-2"}),"تصدير التقرير"]})})]})]})}),s.jsx(p,{value:"rewards",children:s.jsxs(a,{children:[s.jsxs(l,{children:[s.jsx(i,{children:"برنامج المكافآت"}),s.jsx(x,{children:"احصل على مكافآت إضافية عند تحقيق أهداف محددة"})]}),s.jsx(t,{children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"p-4 rounded-lg border border-green-200 bg-green-50",children:[s.jsxs("div",{className:"flex justify-between items-start mb-2",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold",children:"مكافأة 100 مبيعة"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"احصل على $50 إضافية"})]}),s.jsx(j,{variant:"default",children:"89%"})]}),s.jsx(f,{value:89,className:"mt-2"}),s.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"11 مبيعة فقط للوصول للهدف!"})]}),s.jsxs("div",{className:"p-4 rounded-lg border",children:[s.jsxs("div",{className:"flex justify-between items-start mb-2",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold",children:"مكافأة 200 مبيعة"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"احصل على $150 إضافية"})]}),s.jsx(j,{variant:"secondary",children:"44.5%"})]}),s.jsx(f,{value:44.5,className:"mt-2"})]}),s.jsxs("div",{className:"p-4 rounded-lg border",children:[s.jsxs("div",{className:"flex justify-between items-start mb-2",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold",children:"مكافأة 500 مبيعة"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"احصل على $500 إضافية"})]}),s.jsx(j,{variant:"secondary",children:"17.8%"})]}),s.jsx(f,{value:17.8,className:"mt-2"})]})]})})]})})]})]})})}export{gs as default};
