import{r as C,f as D,j as e,a2 as d,aa as L,g as N,b4 as g,aw as f,b5 as h,b6 as S,al as k,aq as I}from"./vendor-react-BTCGZZAN.js";import{o as P,q,C as r,r as x,s as m,f as n,e as i,B as A,l as o,F as O}from"./index-DAwEpow4.js";import"./vendor-ui-BA32w1ww.js";import"./vendor-query-GexG3wnZ.js";import"./vendor-other-ws_0vYaO.js";import"./vendor-animations-W1Z2cmit.js";import"./vendor-appwrite-BQhTxLk4.js";const $={PENDING:{label:"قيد الانتظار",icon:g,color:"bg-yellow-500",variant:"default"},CONFIRMED:{label:"مؤكد",icon:h,color:"bg-blue-500",variant:"default"},SHIPPED:{label:"تم الشحن",icon:f,color:"bg-purple-500",variant:"default"},DELIVERED:{label:"تم التوصيل",icon:h,color:"bg-green-500",variant:"default"},CANCELLED:{label:"ملغي",icon:S,color:"bg-red-500",variant:"destructive"}};function K(){const{user:a}=P(),[j,b]=C.useState(new Set),{data:c=[],isLoading:v,isError:y,error:p}=D({queryKey:q.orders((a==null?void 0:a.$id)||""),queryFn:()=>O.getUserOrders((a==null?void 0:a.$id)||""),enabled:!!(a!=null&&a.$id)}),w=s=>{const l=new Set(j);l.has(s)?l.delete(s):l.add(s),b(l)};return a?v?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(L,{className:"w-8 h-8 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"جاري تحميل طلباتك..."})]})}):y?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs(r,{className:"w-full max-w-md",children:[e.jsx(x,{children:e.jsx(m,{className:"text-center text-red-500",children:"خطأ في التحميل"})}),e.jsxs(n,{className:"text-center",children:[e.jsx("p",{className:"mb-4",children:p instanceof Error?p.message:"حدث خطأ أثناء تحميل الطلبات"}),e.jsx(i,{onClick:()=>window.location.reload(),children:"إعادة المحاولة"})]})]})}):c.length===0?e.jsx("div",{className:"min-h-screen bg-background",children:e.jsxs("div",{className:"container mx-auto px-4 py-16 text-center",children:[e.jsx(N,{className:"h-16 w-16 mx-auto mb-4 text-muted-foreground"}),e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"لا توجد طلبات حتى الآن"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"ابدأ بتصفح منتجاتنا واطلب ما يناسبك"}),e.jsx(i,{asChild:!0,children:e.jsx(d,{to:"/products",children:"تصفح المنتجات"})})]})}):e.jsx("div",{className:"min-h-screen bg-background",children:e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"طلباتي"}),e.jsxs("p",{className:"text-muted-foreground",children:["لديك ",c.length," طلب إجمالي"]})]}),e.jsxs("div",{className:"grid md:grid-cols-4 gap-4 mb-8",children:[e.jsx(r,{children:e.jsx(n,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-yellow-100 rounded-lg",children:e.jsx(g,{className:"h-6 w-6 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:c.filter(s=>s.status==="PENDING").length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"قيد الانتظار"})]})]})})}),e.jsx(r,{children:e.jsx(n,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:e.jsx(f,{className:"h-6 w-6 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:c.filter(s=>s.status==="SHIPPED").length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"تم الشحن"})]})]})})}),e.jsx(r,{children:e.jsx(n,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:e.jsx(h,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:c.filter(s=>s.status==="DELIVERED").length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"تم التوصيل"})]})]})})}),e.jsx(r,{children:e.jsx(n,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-primary/10 rounded-lg",children:e.jsx(N,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:c.reduce((s,l)=>s+l.total,0).toLocaleString()}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"إجمالي المشتريات"})]})]})})})]}),e.jsx("div",{className:"space-y-4",children:c.map(s=>{const l=$[s.status],E=l.icon,u=j.has(s.id);return e.jsxs(r,{children:[e.jsx(x,{className:"pb-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(m,{className:"text-lg",children:s.orderNumber}),e.jsxs(A,{variant:l.variant,className:"flex items-center gap-1",children:[e.jsx(E,{className:"h-3 w-3"}),l.label]})]}),e.jsxs("div",{className:"flex flex-wrap gap-x-6 gap-y-2 text-sm text-muted-foreground",children:[e.jsxs("span",{children:["التاريخ: ",new Date(s.date).toLocaleDateString("ar")]}),e.jsxs("span",{children:[s.itemsCount," منتج"]}),e.jsxs("span",{className:"font-semibold text-primary",children:[s.total.toLocaleString()," ج.م"]})]})]}),e.jsx(i,{variant:"outline",size:"sm",onClick:()=>w(s.id),children:u?e.jsxs(e.Fragment,{children:[e.jsx(k,{className:"h-4 w-4 ml-2 rtl:ml-0 rtl:mr-2"}),"إخفاء التفاصيل"]}):e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"h-4 w-4 ml-2 rtl:ml-0 rtl:mr-2"}),"عرض التفاصيل"]})})]})}),u&&e.jsxs(n,{className:"pt-0 space-y-4",children:[e.jsx(o,{}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-3",children:"المنتجات"}),e.jsx("div",{className:"space-y-3",children:s.items.map(t=>e.jsxs("div",{className:"flex gap-3 p-3 bg-muted rounded-lg",children:[e.jsx(d,{to:`/product/${t.productId}`,children:e.jsx("img",{src:t.image,alt:t.name,className:"w-16 h-16 object-cover rounded"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx(d,{to:`/product/${t.productId}`,className:"hover:text-primary",children:e.jsx("p",{className:"font-medium",children:t.name})}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["الكمية: ",t.quantity," × ",t.price.toLocaleString()," ","ج.م"]})]}),e.jsx("div",{className:"text-left",children:e.jsxs("p",{className:"font-semibold",children:[(t.price*t.quantity).toLocaleString()," ج.م"]})})]},t.id))})]}),e.jsx(o,{}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"عنوان التوصيل"}),e.jsxs("div",{className:"text-sm text-muted-foreground space-y-1",children:[e.jsx("p",{children:s.shippingAddress.city}),e.jsx("p",{children:s.shippingAddress.address}),e.jsx("p",{children:s.shippingAddress.phone})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"تفاصيل الدفع"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"المجموع الفرعي"}),e.jsxs("span",{children:[s.total.toLocaleString()," ج.م"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"الشحن"}),e.jsx("span",{children:"مجاني"})]}),e.jsx(o,{}),e.jsxs("div",{className:"flex justify-between font-bold text-base",children:[e.jsx("span",{children:"الإجمالي"}),e.jsxs("span",{className:"text-primary",children:[s.total.toLocaleString()," ج.م"]})]})]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx(i,{variant:"outline",size:"sm",asChild:!0,children:e.jsx(d,{to:`/orders/${s.id}/track`,children:"تتبع الطلب"})}),s.status==="DELIVERED"&&e.jsx(i,{variant:"outline",size:"sm",children:"إعادة الطلب"}),s.status==="PENDING"&&e.jsx(i,{variant:"destructive",size:"sm",children:"إلغاء الطلب"})]})]})]},s.id)})})]})}):e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs(r,{className:"w-full max-w-md",children:[e.jsx(x,{children:e.jsx(m,{className:"text-center",children:"تسجيل الدخول مطلوب"})}),e.jsxs(n,{className:"text-center",children:[e.jsx("p",{className:"mb-4",children:"يرجى تسجيل الدخول لعرض طلباتك"}),e.jsx(d,{to:"/login",children:e.jsx(i,{children:"تسجيل الدخول"})})]})]})})}export{K as default};
