import{r as C,m as D,j as s,a6 as d,n as N,b7 as g,aA as f,b8 as h,b9 as L,ap as S,au as k}from"./vendor-react-wP-gPk8e.js";import{o as I,q as P,C as c,r as x,s as m,f as n,e as i,B as A,l as o,G as q}from"./index-D1ZXSrVW.js";import{P as O}from"./loading-screen-CDFNHjLA.js";import"./vendor-ui-BA32w1ww.js";import"./vendor-query-GexG3wnZ.js";import"./vendor-other-DcnDEVts.js";import"./vendor-animations-W1Z2cmit.js";import"./vendor-appwrite-BGb_FC-V.js";const $={PENDING:{label:"قيد الانتظار",icon:g,color:"bg-yellow-500",variant:"default"},CONFIRMED:{label:"مؤكد",icon:h,color:"bg-blue-500",variant:"default"},SHIPPED:{label:"تم الشحن",icon:f,color:"bg-purple-500",variant:"default"},DELIVERED:{label:"تم التوصيل",icon:h,color:"bg-green-500",variant:"default"},CANCELLED:{label:"ملغي",icon:L,color:"bg-red-500",variant:"destructive"}};function M(){const{user:a}=I(),[j,b]=C.useState(new Set),{data:r=[],isLoading:v,isError:y,error:p}=D({queryKey:P.orders((a==null?void 0:a.$id)||""),queryFn:()=>q.getUserOrders((a==null?void 0:a.$id)||""),enabled:!!(a!=null&&a.$id)}),w=e=>{const l=new Set(j);l.has(e)?l.delete(e):l.add(e),b(l)};return a?v?s.jsx(O,{message:"جاري تحميل طلباتك..."}):y?s.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:s.jsxs(c,{className:"w-full max-w-md",children:[s.jsx(x,{children:s.jsx(m,{className:"text-center text-red-500",children:"خطأ في التحميل"})}),s.jsxs(n,{className:"text-center",children:[s.jsx("p",{className:"mb-4",children:p instanceof Error?p.message:"حدث خطأ أثناء تحميل الطلبات"}),s.jsx(i,{onClick:()=>window.location.reload(),children:"إعادة المحاولة"})]})]})}):r.length===0?s.jsx("div",{className:"min-h-screen bg-background",children:s.jsxs("div",{className:"container mx-auto px-4 py-16 text-center",children:[s.jsx(N,{className:"h-16 w-16 mx-auto mb-4 text-muted-foreground"}),s.jsx("h1",{className:"text-2xl font-bold mb-4",children:"لا توجد طلبات حتى الآن"}),s.jsx("p",{className:"text-muted-foreground mb-6",children:"ابدأ بتصفح منتجاتنا واطلب ما يناسبك"}),s.jsx(i,{asChild:!0,children:s.jsx(d,{to:"/products",children:"تصفح المنتجات"})})]})}):s.jsx("div",{className:"min-h-screen bg-background",children:s.jsxs("div",{className:"container mx-auto px-4 py-8",children:[s.jsxs("div",{className:"mb-8",children:[s.jsx("h1",{className:"text-3xl font-bold mb-2",children:"طلباتي"}),s.jsxs("p",{className:"text-muted-foreground",children:["لديك ",r.length," طلب إجمالي"]})]}),s.jsxs("div",{className:"grid md:grid-cols-4 gap-4 mb-8",children:[s.jsx(c,{children:s.jsx(n,{className:"p-6",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-3 bg-yellow-100 rounded-lg",children:s.jsx(g,{className:"h-6 w-6 text-yellow-600"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-2xl font-bold",children:r.filter(e=>e.status==="PENDING").length}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"قيد الانتظار"})]})]})})}),s.jsx(c,{children:s.jsx(n,{className:"p-6",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:s.jsx(f,{className:"h-6 w-6 text-purple-600"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-2xl font-bold",children:r.filter(e=>e.status==="SHIPPED").length}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"تم الشحن"})]})]})})}),s.jsx(c,{children:s.jsx(n,{className:"p-6",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:s.jsx(h,{className:"h-6 w-6 text-green-600"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-2xl font-bold",children:r.filter(e=>e.status==="DELIVERED").length}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"تم التوصيل"})]})]})})}),s.jsx(c,{children:s.jsx(n,{className:"p-6",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-3 bg-primary/10 rounded-lg",children:s.jsx(N,{className:"h-6 w-6 text-primary"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-2xl font-bold",children:r.reduce((e,l)=>e+l.total,0).toLocaleString()}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"إجمالي المشتريات"})]})]})})})]}),s.jsx("div",{className:"space-y-4",children:r.map(e=>{const l=$[e.status],E=l.icon,u=j.has(e.id);return s.jsxs(c,{children:[s.jsx(x,{className:"pb-4",children:s.jsxs("div",{className:"flex items-start justify-between gap-4",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx(m,{className:"text-lg",children:e.orderNumber}),s.jsxs(A,{variant:l.variant,className:"flex items-center gap-1",children:[s.jsx(E,{className:"h-3 w-3"}),l.label]})]}),s.jsxs("div",{className:"flex flex-wrap gap-x-6 gap-y-2 text-sm text-muted-foreground",children:[s.jsxs("span",{children:["التاريخ: ",new Date(e.date).toLocaleDateString("ar")]}),s.jsxs("span",{children:[e.itemsCount," منتج"]}),s.jsxs("span",{className:"font-semibold text-primary",children:[e.total.toLocaleString()," ج.م"]})]})]}),s.jsx(i,{variant:"outline",size:"sm",onClick:()=>w(e.id),children:u?s.jsxs(s.Fragment,{children:[s.jsx(S,{className:"h-4 w-4 ml-2 rtl:ml-0 rtl:mr-2"}),"إخفاء التفاصيل"]}):s.jsxs(s.Fragment,{children:[s.jsx(k,{className:"h-4 w-4 ml-2 rtl:ml-0 rtl:mr-2"}),"عرض التفاصيل"]})})]})}),u&&s.jsxs(n,{className:"pt-0 space-y-4",children:[s.jsx(o,{}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold mb-3",children:"المنتجات"}),s.jsx("div",{className:"space-y-3",children:e.items.map(t=>s.jsxs("div",{className:"flex gap-3 p-3 bg-muted rounded-lg",children:[s.jsx(d,{to:`/product/${t.productId}`,children:s.jsx("img",{src:t.image,alt:t.name,className:"w-16 h-16 object-cover rounded"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx(d,{to:`/product/${t.productId}`,className:"hover:text-primary",children:s.jsx("p",{className:"font-medium",children:t.name})}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["الكمية: ",t.quantity," × ",t.price.toLocaleString()," ","ج.م"]})]}),s.jsx("div",{className:"text-left",children:s.jsxs("p",{className:"font-semibold",children:[(t.price*t.quantity).toLocaleString()," ج.م"]})})]},t.id))})]}),s.jsx(o,{}),s.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold mb-2",children:"عنوان التوصيل"}),s.jsxs("div",{className:"text-sm text-muted-foreground space-y-1",children:[s.jsx("p",{children:e.shippingAddress.city}),s.jsx("p",{children:e.shippingAddress.address}),s.jsx("p",{children:e.shippingAddress.phone})]})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold mb-2",children:"تفاصيل الدفع"}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-muted-foreground",children:"المجموع الفرعي"}),s.jsxs("span",{children:[e.total.toLocaleString()," ج.م"]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-muted-foreground",children:"الشحن"}),s.jsx("span",{children:"مجاني"})]}),s.jsx(o,{}),s.jsxs("div",{className:"flex justify-between font-bold text-base",children:[s.jsx("span",{children:"الإجمالي"}),s.jsxs("span",{className:"text-primary",children:[e.total.toLocaleString()," ج.م"]})]})]})]})]}),s.jsxs("div",{className:"flex gap-3 pt-2",children:[s.jsx(i,{variant:"outline",size:"sm",asChild:!0,children:s.jsx(d,{to:`/orders/${e.id}/track`,children:"تتبع الطلب"})}),e.status==="DELIVERED"&&s.jsx(i,{variant:"outline",size:"sm",children:"إعادة الطلب"}),e.status==="PENDING"&&s.jsx(i,{variant:"destructive",size:"sm",children:"إلغاء الطلب"})]})]})]},e.id)})})]})}):s.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:s.jsxs(c,{className:"w-full max-w-md",children:[s.jsx(x,{children:s.jsx(m,{className:"text-center",children:"تسجيل الدخول مطلوب"})}),s.jsxs(n,{className:"text-center",children:[s.jsx("p",{className:"mb-4",children:"يرجى تسجيل الدخول لعرض طلباتك"}),s.jsx(d,{to:"/login",children:s.jsx(i,{children:"تسجيل الدخول"})})]})]})})}export{M as default};
