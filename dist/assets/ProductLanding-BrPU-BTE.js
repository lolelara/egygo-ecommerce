import{j as e,a$ as ae,aj as H,bm as te,l as re,r as d,W as le,m as U,Y as ie,ay as ne,z as $,aC as M,a8 as _,o as ce,ac as oe,bl as de,p as me}from"./vendor-react-CCFRLLzk.js";import{C as c,h as x,f as h,a as xe,g as N,B as K,L as O,d as R,w as he}from"./index-D-h96Znd.js";import{Q as ge}from"./vendor-appwrite-CuqfvTq9.js";import{P as pe}from"./LoadingSkeletons-DwEzCxyX.js";import{S as ue}from"./SEO-B8rW5KXS.js";import"./vendor-ui-BA32w1ww.js";import"./vendor-query-j_rPqiug.js";import"./vendor-other-CzBBjgu5.js";import"./vendor-animations-CPHPqPXb.js";import"./skeleton-udMvYfU3.js";function je({error:o,onRetry:u,title:y="Ø­Ø¯Ø« Ø®Ø·Ø£"}){const z=typeof o=="string"?o:o.message;return e.jsx(c,{className:"border-destructive",children:e.jsx(x,{className:"p-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ae,{className:"h-5 w-5 text-destructive mt-0.5"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("h3",{className:"font-semibold text-destructive",children:y}),e.jsx("p",{className:"text-sm text-muted-foreground",children:z}),u&&e.jsxs(h,{onClick:u,size:"sm",variant:"outline",className:"mt-3",children:[e.jsx(H,{className:"ml-2 h-3 w-3"}),"Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©"]})]})]})})})}const G="";function qe(){var T,F,L;const{linkCode:o}=te(),u=re(),{addItem:y}=xe(),[z,fe]=d.useState(null),[I,J]=d.useState(!1),[r,q]=d.useState(""),[n,A]=d.useState(""),[E,S]=d.useState([]),[P,k]=d.useState([]),[g,W]=d.useState([]),[p,v]=d.useState(0),Y=le(),C=()=>{if(!r||!n||g.length===0)return 0;const a=g.find(t=>t.color===r&&t.size===n);return(a==null?void 0:a.quantity)||0},{data:l,isLoading:V,error:D}=U({queryKey:["affiliate-link",o],queryFn:async()=>{if(!o)throw new Error("Link code is required");const a=await R.listDocuments(G,"affiliate_links",[ge.equal("linkCode",o)]);if(a.documents.length===0)throw new Error("Ø±Ø§Ø¨Ø· ØºÙŠØ± ØµØ§Ù„Ø­");return a.documents[0]},enabled:!!o}),{data:s,isLoading:X}=U({queryKey:["product",l==null?void 0:l.productId],queryFn:()=>he.getById(l.productId),enabled:!!(l!=null&&l.productId)}),Z=ie({mutationFn:async()=>{l&&await R.updateDocument(G,"affiliate_links",l.$id,{clicks:(l.clicks||0)+1,lastClickAt:new Date().toISOString()})},onSuccess:()=>{Y.invalidateQueries({queryKey:["affiliate-link",o]})}});d.useEffect(()=>{l&&!I&&(Z.mutate(),J(!0),sessionStorage.setItem("referralAffiliateId",l.affiliateId),sessionStorage.setItem("referralLinkCode",o||""))},[l,I]),d.useEffect(()=>{if(s){console.log("ğŸ” Product data:",s),console.log("ğŸ“¦ colorSizeInventory:",s.colorSizeInventory),console.log("ğŸ¨ colors:",s.colors),console.log("ğŸ“ sizes:",s.sizes);try{const a=s.colorSizeInventory;if(a&&a!=="[]"&&a!==""){const m=JSON.parse(a);if(console.log("âœ… Parsed inventory:",m),m.length>0){W(m);const B=m.reduce((f,se)=>f+(se.quantity||0),0);v(B),console.log("ğŸ“Š Total stock:",B);const b=new Set,w=new Set;m.forEach(f=>{f.quantity>0&&(b.add(f.color),w.add(f.size))}),S(Array.from(b)),k(Array.from(w)),b.size>0&&!r&&q(Array.from(b)[0]),w.size>0&&!n&&A(Array.from(w)[0]);return}}console.log("âš ï¸ No inventory data, using fallback");const t=s.colors||[],i=s.sizes||[];if(S(t),k(i),t.length>0||i.length>0)v(999),console.log("âœ… Product has colors/sizes, setting stock to 999");else{const m=s.stock||s.stockQuantity||0;v(m>0?m:999),console.log("ğŸ“¦ Using old stock:",m||999)}}catch(a){console.error("âŒ Error parsing inventory:",a);const t=s.colors||[],i=s.sizes||[];S(t),k(i),v(999)}}},[s]);const ee=()=>{var i;if(!s)return;const a=N((i=s.images)==null?void 0:i[0]),t=g.length>0&&r&&n?C():p;y({productId:s.id,name:s.name,price:s.price,image:a,quantity:1,stockQuantity:t,inStock:p>0,selectedColor:r||void 0,selectedSize:n||void 0}),u("/cart")},Q=()=>{var i;if(!s)return;const a=N((i=s.images)==null?void 0:i[0]),t=g.length>0&&r&&n?C():p;y({productId:s.id,name:s.name,price:s.price,image:a,quantity:1,stockQuantity:t,inStock:p>0,selectedColor:r||void 0,selectedSize:n||void 0}),u("/checkout")};if(V||X)return e.jsx("div",{className:"min-h-screen bg-gradient-to-b from-primary/5 to-white",children:e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx(pe,{count:1})})});if(D||!s)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsx("div",{className:"max-w-md w-full px-4",children:e.jsx(je,{error:D||new Error("Ø§Ù„Ù…Ù†ØªØ¬ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯"),onRetry:()=>window.location.reload()})})});const j=s.originalPrice?Math.round((s.originalPrice-s.price)/s.originalPrice*100):0;return e.jsxs(e.Fragment,{children:[e.jsx(ue,{title:`${s.name} - Ø¹Ø±Ø¶ Ø®Ø§Øµ`,description:s.description,ogImage:N((T=s.images)==null?void 0:T[0])}),e.jsx("div",{className:"bg-gradient-to-r from-primary via-orange-500 to-pink-500 text-white",children:e.jsxs("div",{className:"container mx-auto px-4 py-12 text-center",children:[e.jsx(K,{className:"mb-4 bg-white text-primary hover:bg-white",children:"ğŸ”¥ Ø¹Ø±Ø¶ Ø®Ø§Øµ Ù„ÙØªØ±Ø© Ù…Ø­Ø¯ÙˆØ¯Ø©"}),e.jsx("h1",{className:"text-4xl md:text-5xl font-bold mb-4",children:s.name}),j>0&&e.jsxs("p",{className:"text-2xl md:text-3xl font-semibold",children:["ÙˆÙÙ‘Ø± ",j,"% Ø§Ù„Ø¢Ù†!"]})]})}),e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-8 lg:gap-12",children:[e.jsxs("div",{children:[e.jsx(c,{className:"overflow-hidden shadow-xl",children:e.jsx("img",{src:N((F=s.images)==null?void 0:F[0]),alt:s.name,className:"w-full aspect-square object-cover"})}),s.images&&s.images.length>1&&e.jsx("div",{className:"grid grid-cols-4 gap-2 mt-4",children:s.images.slice(1,5).map((a,t)=>{const i=N(a);return e.jsx(c,{className:"overflow-hidden cursor-pointer hover:ring-2 hover:ring-primary transition-all",children:e.jsx("img",{src:i,alt:`${s.name} ${t+2}`,className:"w-full aspect-square object-cover"})},t)})})]}),e.jsxs("div",{className:"space-y-6",children:[s.rating>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex",children:[...Array(5)].map((a,t)=>e.jsx(ne,{className:`h-5 w-5 ${t<Math.round(s.rating)?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},t))}),e.jsxs("span",{className:"text-sm text-gray-600",children:[s.rating.toFixed(1)," (",s.reviewCount," ØªÙ‚ÙŠÙŠÙ…)"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-baseline gap-3",children:[e.jsxs("span",{className:"text-5xl font-bold text-primary",children:[s.price.toFixed(2)," Ø¬Ù†ÙŠÙ‡"]}),s.originalPrice&&e.jsxs("span",{className:"text-2xl text-gray-400 line-through",children:[s.originalPrice.toFixed(2)," Ø¬Ù†ÙŠÙ‡"]})]}),j>0&&e.jsxs(K,{variant:"destructive",className:"text-lg px-3 py-1",children:["ÙˆÙÙ‘Ø± ",(s.originalPrice-s.price).toFixed(2)," Ø¬Ù†ÙŠÙ‡"]})]}),e.jsx(c,{className:"bg-green-50 border-green-200",children:e.jsxs(x,{className:"p-4 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-green-700",children:[e.jsx($,{className:"h-5 w-5"}),e.jsx("span",{children:"Ø¶Ù…Ø§Ù† Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„Ù…Ø§Ù„ Ø®Ù„Ø§Ù„ 14 ÙŠÙˆÙ…"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-green-700",children:[e.jsx(M,{className:"h-5 w-5"}),e.jsx("span",{children:"Ø´Ø­Ù† Ù…Ø¬Ø§Ù†ÙŠ Ù„Ù„Ø·Ù„Ø¨Ø§Øª ÙÙˆÙ‚ 500 Ø¬Ù†ÙŠÙ‡"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-green-700",children:[e.jsx(_,{className:"h-5 w-5"}),e.jsx("span",{children:"Ù…Ù†ØªØ¬ Ø£ØµÙ„ÙŠ 100%"})]})]})}),p>0?e.jsxs("div",{className:"flex items-center gap-2 text-green-600",children:[e.jsx($,{className:"h-5 w-5"}),e.jsx("span",{className:"font-semibold",children:"Ù…ØªÙˆÙØ± ÙÙŠ Ø§Ù„Ù…Ø®Ø²ÙˆÙ†"}),g.length>0&&r&&n&&e.jsxs("span",{className:"text-sm text-muted-foreground",children:["(",C()," Ù…ØªÙˆÙØ±)"]})]}):e.jsx("div",{className:"text-red-600 font-semibold",children:"ØºÙŠØ± Ù…ØªÙˆÙØ± Ø­Ø§Ù„ÙŠØ§Ù‹"}),E.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(O,{className:"text-base font-semibold",children:"Ø§Ø®ØªØ± Ø§Ù„Ù„ÙˆÙ†:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:E.map((a,t)=>e.jsx(h,{variant:r===a?"default":"outline",className:"min-w-[80px]",onClick:()=>q(a),children:a},t))}),r&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["ØªÙ… Ø§Ø®ØªÙŠØ§Ø±: ",e.jsx("span",{className:"font-semibold",children:r})]})]}),P.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(O,{className:"text-base font-semibold",children:"Ø§Ø®ØªØ± Ø§Ù„Ù…Ù‚Ø§Ø³:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:P.map((a,t)=>e.jsx(h,{variant:n===a?"default":"outline",className:"min-w-[60px]",onClick:()=>A(a),children:a},t))}),n&&r&&g.length>0&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…ØªØ§Ø­Ø©: ",e.jsxs("span",{className:"font-semibold",children:[((L=g.find(a=>a.color===r&&a.size===n))==null?void 0:L.quantity)||0," Ù‚Ø·Ø¹Ø©"]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(h,{onClick:Q,size:"lg",className:"w-full text-lg h-14 bg-gradient-to-r from-primary to-orange-500 hover:from-primary/90 hover:to-orange-600",disabled:p===0,children:[e.jsx(ce,{className:"ml-2 h-6 w-6"}),"Ø§Ø´ØªØ±Ù Ø§Ù„Ø¢Ù† - ÙˆÙÙ‘Ø± ",j,"%"]}),e.jsx(h,{onClick:ee,variant:"outline",size:"lg",className:"w-full text-lg h-14",disabled:p===0,children:"Ø£Ø¶Ù Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(h,{variant:"outline",size:"icon",children:e.jsx(oe,{className:"h-5 w-5"})}),e.jsx(h,{variant:"outline",size:"icon",children:e.jsx(de,{className:"h-5 w-5"})})]})]})]}),e.jsxs("div",{className:"mt-12",children:[e.jsx("h2",{className:"text-3xl font-bold mb-6",children:"ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬"}),e.jsx(c,{children:e.jsx(x,{className:"p-6",children:e.jsx("p",{className:"text-lg text-gray-700 leading-relaxed whitespace-pre-wrap",children:s.description})})})]}),s.reviewCount>0&&e.jsxs("div",{className:"mt-12",children:[e.jsxs("h2",{className:"text-3xl font-bold mb-6",children:["Ø¢Ø±Ø§Ø¡ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ (",s.reviewCount,")"]}),e.jsx(c,{children:e.jsx(x,{className:"p-6",children:e.jsx("div",{className:"text-center text-gray-500",children:"Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ù‚Ø§Ø¯Ù…Ø© Ù‚Ø±ÙŠØ¨Ø§Ù‹..."})})})]}),e.jsxs("div",{className:"mt-12 grid md:grid-cols-4 gap-6",children:[e.jsx(c,{children:e.jsxs(x,{className:"p-6 text-center",children:[e.jsx(_,{className:"h-12 w-12 mx-auto mb-3 text-primary"}),e.jsx("h3",{className:"font-semibold mb-2",children:"Ø¯ÙØ¹ Ø¢Ù…Ù†"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ù…Ø­Ù…ÙŠØ© ÙˆÙ…Ø´ÙØ±Ø©"})]})}),e.jsx(c,{children:e.jsxs(x,{className:"p-6 text-center",children:[e.jsx(M,{className:"h-12 w-12 mx-auto mb-3 text-primary"}),e.jsx("h3",{className:"font-semibold mb-2",children:"Ø´Ø­Ù† Ø³Ø±ÙŠØ¹"}),e.jsx("p",{className:"text-sm text-gray-600",children:"ØªÙˆØµÙŠÙ„ Ø®Ù„Ø§Ù„ 2-5 Ø£ÙŠØ§Ù… Ø¹Ù…Ù„"})]})}),e.jsx(c,{children:e.jsxs(x,{className:"p-6 text-center",children:[e.jsx(H,{className:"h-12 w-12 mx-auto mb-3 text-primary"}),e.jsx("h3",{className:"font-semibold mb-2",children:"Ø¥Ø±Ø¬Ø§Ø¹ Ù…Ø¬Ø§Ù†ÙŠ"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„Ù…Ø§Ù„ Ø®Ù„Ø§Ù„ 14 ÙŠÙˆÙ…"})]})}),e.jsx(c,{children:e.jsxs(x,{className:"p-6 text-center",children:[e.jsx(me,{className:"h-12 w-12 mx-auto mb-3 text-primary"}),e.jsx("h3",{className:"font-semibold mb-2",children:"Ø§Ù„Ø£ÙƒØ«Ø± Ù…Ø¨ÙŠØ¹Ø§Ù‹"}),e.jsx("p",{className:"text-sm text-gray-600",children:"ÙŠØ«Ù‚ Ø¨Ù‡ Ø¢Ù„Ø§Ù Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡"})]})})]}),e.jsx(c,{className:"mt-12 bg-gradient-to-r from-primary/10 to-orange-500/10 border-primary",children:e.jsxs(x,{className:"p-8 text-center",children:[e.jsx("h2",{className:"text-3xl font-bold mb-4",children:"Ù„Ø§ ØªÙÙˆØª Ù‡Ø°Ø§ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø®Ø§Øµ!"}),e.jsxs("p",{className:"text-lg text-gray-700 mb-6",children:["Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ ",s.name," Ø§Ù„Ø¢Ù† Ø¨Ø³Ø¹Ø± Ù…Ø®ÙÙ‘Ø¶"]}),e.jsxs(h,{onClick:Q,size:"lg",className:"text-xl px-12 h-16 bg-gradient-to-r from-primary to-orange-500",disabled:!s.inStock,children:["Ø§Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù† - ÙˆÙÙ‘Ø± ",j,"%!"]})]})})]})]})}export{qe as default};
